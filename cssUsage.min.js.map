{"version":3,"sources":["cssUsage.src.js"],"names":["_","ArrayWrapper","a","mapInline","map","bind","filter","reduce","window","CSSUsageLodash","array","source","f","v","value","transform","clone","Array","length","i","shouldValueBeIncluded","s","computeReduction","reduction","shorthands","shorthandProperties","expandCache","Object","create","unexpandCache","expand","property","result","prefixData","match","prefix","prefixFreeProperty","hasOwnProperty","forEach","p","longhand","push","apply","unexpand","sh","shorthand","indexOf","call","CSSShorthands","hasBluePrintUsage","document","querySelector","detectedBootstrapGridUsages","domClasses","trackedClasses","sizes","size","j","k","b","detectedBootstrapFormUsages","detectedBootstrapAlertUsages","detectedBootstrapFloatUsages","hasDogfaloMaterializeUsage","classesToLookUp","d","hasGrumbyUsage","cl","fraction","hasInuitUsage","cu","subClassesToLookUp","sc","ns","getLonelyGatesUsage","cssLonelyClassGates","domIds","cssLonelyIdGates","undefined","cssUniqueLonelyClassGatesArray","keys","cssUniqueLonelyClassGatesUsedArray","c","cssUniqueLonelyClassGatesUsedWorthArray","debugCSSUsage","console","log","cssUniqueLonelyIdGatesArray","cssUniqueLonelyIdGatesUsedArray","cssUniqueLonelyIdGatesUsedWorthArray","detectedModernizerUsages","ModernizerUsages","count","values","tc","countInstancesOfTheClass","getFwkUsage","results","cssClasses","FwkModernizer","Modernizer","FwkModernizerDOMUsages","FwkModernizerCSSUsages","FwkBootstrap","jQuery","$","fn","modal","FwkBootstrapGridUsage","FwkBootstrapFormUsage","FwkBootstrapFloatUsage","FwkBootstrapAlertUsage","FwkBootstrapGridRecognized","FwkBootstrapFormRecognized","FwkBootstrapFloatRecognized","FwkBootstrapAlertRecognized","FwkGrumby","FwkInuit","FwkBluePrint","FwkDogfaloMaterialize","detectedClearfixUsages","detectedVisibilityUsages","getPatternUsage","PatClearfixUsage","PatVisibilityUsage","PatClearfixRecognized","PatVisibilityRecognized","HtmlUsage","GetNodeName","element","HTMLUnknownElement","node","nodeName","tags","HtmlUsageResults","tag","GetAttributes","attributes","att","IsValidAttribute","attribute","attributeTag","attname","browserIsEdge","navigator","userAgent","browserIsFirefox","top","location","href","Error","CSSUsage","String","prototype","trim","warn","replace","RecipeResults","Recipes","recipes","CSSUsageResults","types","props","usages","rules","StyleWalker","ruleAnalyzers","elementAnalyzers","recipesToRun","runRecipes","walkOverCssStyles","walkOverDomElements","amountOfInlineStyles","amountOfSelectorsUnused","amountOfSelectors","hasWalkedDomElementsOnce","keyframes","styleSheets","ssIndex","styleSheet","cssRules","walkOverCssRules","e","stack","animations","animation","keyframe","matchCount","fakeElements","initArray","tagName","processRule","parentMatchedElements","ruleIndex","rule","type","name","CSS","supports","conditionText","parentStyleSheet","style","selectorText","matchedElements","PropertyValuesAnalyzer","cleanSelectorText","slice","querySelectorAll","ex","runRuleAnalyzers","obj","index","documentElement","elements","all","runElementAnalyzers","hasAttribute","ruleType","isInline","r","recipeToRun","runAnalyzer","depth","initializer","CSSValues","createValueArray","parseValues","normalizeValue","propertyName","toLowerCase","isKeywordColor","numbers","m","nstr","nint","RegExp","split","candidateColor","isColorKeyword","test","analyzeStyleOfRule","generalizedSelectorsOf","finalize","defaultStyle","getComputedStyle","createElement","getBuggyValuesForThisBrowser","buggyValues","cache","valueExistsInRootProperty","cssText","key","rootKey","buggyState","validValues","validValuesExtractor","exec","selector","selectorCat","isRuleUnused","generalizedSelectors","concat","generalizedSelectorsData","generalizedSelector","generalizedSelectorData","rootKeyIndex","substr","normalizedKey","styleValue","getPropertyValue","isValueInvalid","isPropertyUndefined","specifiedValuesArray","gs","propStats","propObject","cssUsageMeta","knownValues","valuesArray","sv","currentSV","removeAnimationNames","text","sortSelectorComponents","ID_REGEXP","CLASS_REGEXP","ATTR_REGEXP","PSEUDO_REGEXP","SORT_REGEXPS","oldValue","wrongPair","cssPseudos","cssIds","cssLonelyClassGatesMatches","cssLonelyIdGatesMatches","ID_REGEXP1","CLASS_REGEXP1","GATEID_REGEXP","GATECLASS_REGEXP","extractFeature","feature","counters","instances","instance","SelectorAnalyzer","parseSelector","selectorsText","selectors","DOMClassAnalyzer","className","elementClasses","classList","id","domClassesArray","cssClassesArray","domIdsArray","cssIdsArray","SuccessfulCrawls","DOMElements","SelectorsFound","InlineStylesFound","SelectorsUnused","IdsUsed","IdsRecognized","IdsUsedRecognized","ClassesUsed","ClassesRecognized","ClassesUsedRecognized","readyState","addEventListener","onready","setTimeout","firstTime","hasAlreadyRun","startTime","performance","now","duration","onCSSUsageResults","metaviewport","needles","n","needle","paddingHack","parseFloat"],"mappings":";;AAAA,KAAK,YAAW;;AAEf,KAAIA,IAAK,SAALA,CAAK;AAAA,SAAK,IAAIC,YAAJ,CAAiBC,CAAjB,CAAL;AAAA,EAAT;AACAF,GAAEG,SAAF,GAAcA,SAAd;AACAH,GAAEI,GAAF,GAAQA,GAAR,CAAyBA,IAAIC,IAAJ,GAAY;AAAA,SAAID,GAAJ;AAAA,EAAZ;AACzBJ,GAAEM,MAAF,GAAWA,MAAX,CAAyBA,OAAOD,IAAP,GAAe;AAAA,SAAIC,MAAJ;AAAA,EAAf;AACzBN,GAAEO,MAAF,GAAWA,MAAX,CAAyBA,OAAOF,IAAP,GAAe;AAAA,SAAIE,MAAJ;AAAA,EAAf;AACzBC,QAAOC,cAAP,GAAwBT,CAAxB;;;AAIA,UAASC,YAAT,CAAsBS,KAAtB,EAA6B;AAC5B,OAAKC,MAAL,GAAcD,KAAd;AACA,OAAKP,SAAL,GAAiB,UAASS,CAAT,EAAY;AAAET,aAAU,KAAKQ,MAAf,EAAuBC,CAAvB,EAA2B,OAAO,IAAP;AAAc,GAAxE;AACA,OAAKR,GAAL,GAAW,UAASQ,CAAT,EAAY;AAAE,QAAKD,MAAL,GAAcP,IAAI,KAAKO,MAAT,EAAiBC,CAAjB,CAAd,CAAmC,OAAO,IAAP;AAAc,GAA1E;AACA,OAAKN,MAAL,GAAc,UAASM,CAAT,EAAY;AAAE,QAAKD,MAAL,GAAcL,OAAO,KAAKK,MAAZ,EAAoBC,CAApB,CAAd,CAAsC,OAAO,IAAP;AAAc,GAAhF;AACA,OAAKL,MAAL,GAAc,UAASM,CAAT,EAAWD,CAAX,EAAc;AAAE,QAAKD,MAAL,GAAcJ,OAAO,KAAKI,MAAZ,EAAoBC,CAApB,EAAuBC,CAAvB,CAAd,CAAyC,OAAO,IAAP;AAAc,GAArF;AACA,OAAKC,KAAL,GAAa,YAAW;AAAE,UAAO,KAAKH,MAAZ;AAAoB,GAA9C;AACA;;AAED,UAASP,GAAT,CAAaO,MAAb,EAAqBI,SAArB,EAAgC;AAC/B,MAAIC,QAAQ,IAAIC,KAAJ,CAAUN,OAAOO,MAAjB,CAAZ;AACA,OAAI,IAAIC,IAAIR,OAAOO,MAAnB,EAA2BC,GAA3B,GAAiC;AAChCH,SAAMG,CAAN,IAAWJ,UAAUJ,OAAOQ,CAAP,CAAV,CAAX;AACA;AACD,SAAOH,KAAP;AACA;;AAED,UAASb,SAAT,CAAmBQ,MAAnB,EAA2BI,SAA3B,EAAsC;AACrC,OAAI,IAAII,IAAIR,OAAOO,MAAnB,EAA2BC,GAA3B,GAAiC;AAChCR,UAAOQ,CAAP,IAAYJ,UAAUJ,OAAOQ,CAAP,CAAV,CAAZ;AACA;AACD,SAAOR,MAAP;AACA;;AAED,UAASL,MAAT,CAAgBK,MAAhB,EAAwBS,qBAAxB,EAA+C;AAC9C,MAAIJ,QAAQ,IAAIC,KAAJ,CAAUN,OAAOO,MAAjB,CAAZ;AAAA,MAAsCC,IAAE,CAAxC;AACA,OAAI,IAAIE,IAAI,CAAZ,EAAeA,KAAKV,OAAOO,MAA3B,EAAmCG,GAAnC,EAAwC;AACvC,OAAIP,QAAQH,OAAOU,CAAP,CAAZ;AACA,OAAGD,sBAAsBN,KAAtB,CAAH,EAAiC;AAChCE,UAAMG,GAAN,IAAaL,KAAb;AACA;AACD;AACDE,QAAME,MAAN,GAAeC,CAAf;AACA,SAAOH,KAAP;AACA;;AAED,UAAST,MAAT,CAAgBI,MAAhB,EAAwBW,gBAAxB,EAA0CC,SAA1C,EAAqD;AACpD,OAAI,IAAIF,IAAI,CAAZ,EAAeA,KAAKV,OAAOO,MAA3B,EAAmCG,GAAnC,EAAwC;AACvC,OAAIP,QAAQH,OAAOU,CAAP,CAAZ;AACAE,eAAYD,iBAAiBC,SAAjB,EAA4BT,KAA5B,CAAZ;AACA;AACD,SAAOS,SAAP;AACA;AAED,CAvDI,EAAL;;AA6DA,KAAK,YAAY;AAIb,KAAIC,aAAa,KAAKC,mBAAL,GAA2B;AAGxC,gBAAuB,CAAC,OAAD,EAAU,WAAV,EAAuB,QAAvB,CAHiB;AAIxC,YAAuB,CAAC,MAAD,EAAS,QAAT,EAAmB,SAAnB,EAA8B,OAA9B,CAJiB;AAKxC,aAAuB,CAAC,QAAD,EAAW,QAAX,EAAqB,QAArB,CALiB;AAMxC,aAAuB,CAAC,MAAD,EAAS,QAAT,EAAmB,SAAnB,EAA8B,OAA9B,CANiB;;AASxC,gBAAuB,CAAC,QAAD,EAAW,WAAX,EAAwB,OAAxB,EAAiC,SAAjC,EAA4C,SAA5C,EAAuD,OAAvD,EAAgE,aAAhE,EAA+E,QAA/E,CATiB;AAU9C,uBAAuB,CAAC,IAAD,EAAM,IAAN,CAVuB;AAW9C,yBAAuB,CAAC,IAAD,EAAM,IAAN,CAXuB;AAYxC,YAAuB,CAAC,QAAD,EAAW,QAAX,EAAqB,QAArB,CAZiB;AAaxC,kBAAuB,CAAC,kBAAD,EAAqB,oBAArB,EAA2C,qBAA3C,EAAkE,mBAAlE,CAbiB;AAcxC,kBAAuB,CAAC,kBAAD,EAAqB,oBAArB,EAA2C,qBAA3C,EAAkE,mBAAlE,CAdiB;AAexC,kBAAuB,CAAC,kBAAD,EAAqB,oBAArB,EAA2C,qBAA3C,EAAkE,mBAAlE,CAfiB;AAgBxC,gBAAuB,CAAC,QAAD,EAAW,QAAX,EAAqB,QAArB,CAhBiB;AAiBxC,kBAAuB,CAAC,QAAD,EAAW,QAAX,EAAqB,QAArB,CAjBiB;AAkBxC,mBAAuB,CAAC,QAAD,EAAW,QAAX,EAAqB,QAArB,CAlBiB;AAmBxC,iBAAuB,CAAC,QAAD,EAAW,QAAX,EAAqB,QAArB,CAnBiB;AAoBxC,mBAAuB,CAAC,wBAAD,EAA2B,yBAA3B,EAAsD,4BAAtD,EAAoF,2BAApF,CApBiB;AAqBxC,kBAAuB,CAAC,SAAD,EAAY,QAAZ,EAAsB,QAAtB,EAAgC,SAAhC,EAA2C,SAA3C,CArBiB;;AAwBxC,UAAuB,CAAC,QAAD,EAAW,UAAX,EAAuB,SAAvB,EAAkC,UAAlC,EAA8C,OAA9C,EAAuD,aAAvD,EAAsE,SAAtE,CAxBiB;AAyBxC,kBAAuB,CAAC,YAAD,EAAe,aAAf,EAA8B,OAA9B,EAAuC,UAAvC,EAAmD,aAAnD,CAzBiB;;AA4BxC,UAAuB,CAAC,QAAD,EAAW,OAAX,EAAoB,WAApB,EAAiC,OAAjC,EAA0C,SAA1C,EAAqD,SAArD,EAAgE,OAAhE,CA5BiB;AA6BxC,iBAAuB,CAAC,SAAD,EAAY,QAAZ,EAAsB,QAAtB,EAAgC,SAAhC,EAA2C,SAA3C,EAAsD,OAAtD,CA7BiB;;AAgCxC,aAAuB,CAAC,cAAD,EAAiB,cAAjB,CAhCiB;AAiCxC,iBAAuB,CAAC,QAAD,EAAW,QAAX,EAAqB,QAArB,CAjCiB;;AAoCxC,SAAuB,CAAC,SAAD,EAAY,QAAZ,CApCiB;AAqCxC,WAAuB,CAAC,SAAD,EAAY,QAAZ,CArCiB;AAsCxC,UAAuB,CAAC,SAAD,EAAY,QAAZ,CAtCiB;;AAyCxC,qBAAuB,CAAC,OAAD,EAAU,QAAV,EAAoB,QAApB,CAzCiB;AA0CxC,mBAAuB,CAAC,QAAD,EAAW,QAAX,CA1CiB;;AA6CxC,eAAuB,CAAC,OAAD,EAAU,WAAV,EAAuB,kBAAvB,EAA2C,QAA3C,EAAqD,kBAArD,EAAyE,YAAzE,EAAuF,YAAvF,EAAqG,aAArG,CA7CiB;;AAgDxC,gBAAuB,CAAC,WAAD,EAAc,WAAd,EAA2B,kBAA3B,EAA+C,QAA/C,CAhDiB;;AAmDxC,UAAuB,CAAC,OAAD,EAAU,SAAV,EAAqB,QAArB,CAnDiB;;AAsD9C,UAAuB,CAAC,WAAD,EAAc,YAAd,EAA4B,YAA5B,EAAyC,eAAzC,CAtDuB;AAuD9C,mBAAuB,CAAC,OAAD,EAAU,UAAV,EAAsB,QAAtB,CAvDuB;;AA0D9C,cAAuB,CAAC,IAAD,EAAM,IAAN,EAAW,QAAX,CA1DuB,EAA5C;;AA8DH,KAAIC,cAAcC,OAAOC,MAAP,CAAc,IAAd,CAAlB;AACA,KAAIC,gBAAgBF,OAAOC,MAAP,CAAc,IAAd,CAApB;;AAOG,MAAKE,MAAL,GAAc,UAAUC,QAAV,EAAoB;AAAA;;AAEpC,MAAIC,SAASN,YAAYK,QAAZ,CAAb;AACA,MAAGC,MAAH,EAAW;AAAE,UAAOA,MAAP;AAAgB;;AAE7B,MAAIC,aAAaF,SAASG,KAAT,CAAe,sBAAf,CAAjB;AACA,MAAIC,SAASF,WAAW,CAAX,KAAe,EAA5B;AAAA,MAAgCG,qBAAqBH,WAAW,CAAX,KAAe,EAApE;AACM,MAAI,CAACT,WAAWa,cAAX,CAA0BD,kBAA1B,CAAL,EAAoD;AAChD,UAAO,EAAP;AACH;;AAEPJ,WAAS,EAAT;AACMR,aAAWY,kBAAX,EAA+BE,OAA/B,CAAuC,UAACC,CAAD,EAAO;AAC1C,OAAIC,WAAWD,EAAE,CAAF,MAAS,GAAT,GAAeR,WAAWQ,CAA1B,GAA8BJ,SAASI,CAAtD;AACAP,UAAOS,IAAP,CAAYD,QAAZ;AACTR,UAAOS,IAAP,CAAYC,KAAZ,CAAkBV,MAAlB,EAA0B,MAAKF,MAAL,CAAYU,QAAZ,CAA1B;AACM,GAJD;;AAMN,SAAOd,YAAYK,QAAZ,IAAwBC,MAA/B;AAEG,EApBD;;AA2BH,MAAKW,QAAL,GAAgB,SAASA,QAAT,CAAkBZ,QAAlB,EAA4B;;AAE3C,MAAIC,SAASH,cAAcE,QAAd,CAAb;AACA,MAAGC,MAAH,EAAW;AAAE,UAAOA,MAAP;AAAgB;;AAE7B,MAAIC,aAAaF,SAASG,KAAT,CAAe,sBAAf,CAAjB;AACA,MAAIC,SAASF,WAAW,CAAX,KAAe,EAA5B;AAAA,MAAgCG,qBAAqBH,WAAW,CAAX,KAAe,EAApE;;AAEAD,WAAS,EAAT;AACA,OAAI,IAAIY,KAAK,CAAb,EAAgBA,MAAMpB,WAAWN,MAAjC,EAAyC0B,IAAzC,EAA+C;AACrC,OAAIC,YAAYrB,WAAWoB,EAAX,CAAhB;AACT,OAAG,KAAKd,MAAL,CAAYe,SAAZ,EAAuBC,OAAvB,CAA+BV,kBAA/B,KAAsD,CAAzD,EAA4D;AAC3DJ,WAAOS,IAAP,CAAYN,SAAOU,SAAnB;AACAb,WAAOS,IAAP,CAAYC,KAAZ,CAAkBV,MAAlB,EAAyB,KAAKW,QAAL,CAAcR,SAAOU,SAArB,CAAzB;AACA;AACD;;AAED,SAAOhB,cAAcE,QAAd,IAA0BC,MAAjC;AAEA,EAnBD;AAqBA,CA1HI,CA0HHe,IA1HG,CA0HEvC,OAAOwC,aAAP,GAAqB,EA1HvB,CAAL;;AA8HA,IAAIC,oBAAoB,SAApBA,iBAAoB,GAAW;;AAE/B,KAAG,CAACC,SAASC,aAAT,CAAuB,YAAvB,CAAJ,EAA0C;AACtC,SAAO,KAAP;AACH;;AAED,MAAI,IAAIhC,IAAI,KAAG,CAAf,EAAkB,EAAEA,CAApB,GAAwB;AACpB,MAAG+B,SAASC,aAAT,CAAuB,wBAAsBhC,CAA7C,CAAH,EAAoD;AAChD,UAAO,IAAP;AACH;AACJ;AACD,QAAO,KAAP;AAEH,CAbD;;;AAmBA,IAAIiC,8BAA8B,SAA9BA,2BAA8B,CAASC,UAAT,EAAqB;AACnD,KAAIrD,IAAIQ,OAAOC,cAAf;AACH,KAAIF,SAASP,EAAEO,MAAF,CAASF,IAAT,CAAcL,CAAd,CAAb;AACG,KAAIsD,iBAAiB,EAArB;;AAEA,KAAIC,QAAQ,CAAC,IAAD,EAAM,IAAN,EAAW,IAAX,EAAgB,IAAhB,CAAZ;AACA,MAAI,IAAIpC,IAAIoC,MAAMrC,MAAlB,EAA0BC,GAA1B,GAAgC;AAAE,MAAIqC,OAAOD,MAAMpC,CAAN,CAAX;AAC9B,OAAI,IAAIsC,IAAI,KAAG,CAAf,EAAkB,EAAEA,CAApB,GAAwB;AACpBH,kBAAeb,IAAf,CAAoB,SAAOe,IAAP,GAAY,GAAZ,GAAgBC,CAApC;AACA,QAAI,IAAIC,IAAI,KAAG,CAAf,EAAkB,EAAEA,CAApB,GAAwB;AACpBJ,mBAAeb,IAAf,CAAoB,SAAOe,IAAP,GAAY,GAAZ,GAAgBC,CAAhB,GAAkB,UAAlB,GAA6BC,CAAjD;AACAJ,mBAAeb,IAAf,CAAoB,SAAOe,IAAP,GAAY,GAAZ,GAAgBC,CAAhB,GAAkB,QAAlB,GAA2BC,CAA/C;AACAJ,mBAAeb,IAAf,CAAoB,SAAOe,IAAP,GAAY,GAAZ,GAAgBC,CAAhB,GAAkB,QAAlB,GAA2BC,CAA/C;AACH;AACJ;AACJ;;AAED,QAAOnD,OAAO+C,cAAP,EAAuB,UAACpD,CAAD,EAAGyD,CAAH;AAAA,SAASzD,KAAGmD,WAAWM,CAAX,IAAc,CAAjB,CAAT;AAAA,EAAvB,EAAqD,CAArD,CAAP;AAEH,CAnBD;;AAqBA,IAAIC,8BAA8B,SAA9BA,2BAA8B,CAASP,UAAT,EAAqB;AACnD,KAAIrD,IAAIQ,OAAOC,cAAf;AACH,KAAIF,SAASP,EAAEO,MAAF,CAASF,IAAT,CAAcL,CAAd,CAAb;AACG,KAAIsD,iBAAiB,CACjB,YADiB,EACH,eADG,EACc,eADd,EAC+B,eAD/B,EACgD,eADhD,EAEjB,cAFiB,EAED,iBAFC,EAEkB,aAFlB,EAGjB,KAHiB,EAGX,aAHW,EAGG,eAHH,EAGmB,aAHnB,EAGiC,aAHjC,EAG+C,YAH/C,EAG4D,WAH5D,CAArB;;AAMA,QAAO/C,OAAO+C,cAAP,EAAuB,UAACpD,CAAD,EAAGyD,CAAH;AAAA,SAASzD,KAAGmD,WAAWM,CAAX,IAAc,CAAjB,CAAT;AAAA,EAAvB,EAAqD,CAArD,CAAP;AAEH,CAXD;;AAaA,IAAIE,+BAA+B,SAA/BA,4BAA+B,CAASR,UAAT,EAAqB;AACpD,KAAIrD,IAAIQ,OAAOC,cAAf;AACH,KAAIF,SAASP,EAAEO,MAAF,CAASF,IAAT,CAAcL,CAAd,CAAb;AACG,KAAIsD,iBAAiB,CACjB,OADiB,EACT,eADS,EACO,iBADP,EACyB,eADzB,EACyC,eADzC,EACyD,cADzD,EACwE,aADxE,CAArB;;AAIA,QAAO/C,OAAO+C,cAAP,EAAuB,UAACpD,CAAD,EAAGyD,CAAH;AAAA,SAASzD,KAAGmD,WAAWM,CAAX,IAAc,CAAjB,CAAT;AAAA,EAAvB,EAAqD,CAArD,CAAP;AAEH,CATD;;AAWA,IAAIG,+BAA+B,SAA/BA,4BAA+B,CAAST,UAAT,EAAqB;AACpD,KAAIrD,IAAIQ,OAAOC,cAAf;AACH,KAAIF,SAASP,EAAEO,MAAF,CAASF,IAAT,CAAcL,CAAd,CAAb;AACG,KAAIsD,iBAAiB,CACjB,WADiB,EACL,YADK,CAArB;;AAIA,QAAO/C,OAAO+C,cAAP,EAAuB,UAACpD,CAAD,EAAGyD,CAAH;AAAA,SAASzD,KAAGmD,WAAWM,CAAX,IAAc,CAAjB,CAAT;AAAA,EAAvB,EAAqD,CAArD,CAAP;AAEH,CATD;;AAWA,IAAII,6BAA6B,SAA7BA,0BAA6B,GAAW;;AAExC,KAAG,CAACb,SAASC,aAAT,CAAuB,0BAAvB,CAAJ,EAAwD;AACpD,SAAO,KAAP;AACH;;AAED,MAAI,IAAIhC,IAAI,KAAG,CAAf,EAAkB,EAAEA,CAApB,GAAwB;AACpB,MAAI6C,kBAAkB,CAAC,GAAD,EAAK,GAAL,EAAS,GAAT,CAAtB;AACA,OAAI,IAAIC,IAAI,CAAZ,EAAeA,IAAID,gBAAgB9C,MAAnC,EAA2C+C,GAA3C,EAAgD;AAC5C,OAAI5C,IAAI2C,gBAAgBC,CAAhB,CAAR;AACA,OAAGf,SAASC,aAAT,CAAuB,8BAA4B9B,CAA5B,GAA8B,EAA9B,GAAiCF,CAAxD,CAAH,EAA+D;AAC3D,WAAO,IAAP;AACH;AACJ;AACJ;AACD,QAAO,KAAP;AAEH,CAjBD;;AAmBA,IAAI+C,iBAAiB,SAAjBA,cAAiB,GAAW;;AAE5B,KAAG,CAAChB,SAASC,aAAT,CAAuB,eAAvB,CAAJ,EAA6C;AACzC,SAAO,KAAP;AACH;;AAED,KAAIa,kBAAkB,CAAC,KAAD,EAAO,KAAP,EAAa,OAAb,EAAqB,MAArB,EAA4B,MAA5B,EAAmC,KAAnC,EAAyC,OAAzC,EAAiD,OAAjD,EAAyD,MAAzD,EAAgE,KAAhE,EAAsE,QAAtE,EAA+E,QAA/E,CAAtB;AACA,MAAI,IAAIG,KAAK,CAAb,EAAgBA,KAAKH,gBAAgB9C,MAArC,EAA6CiD,IAA7C,EAAoD;AAChD,MAAIC,WAAWJ,gBAAgBG,EAAhB,CAAf;AACA,MAAGjB,SAASC,aAAT,CAAuB,qBAAmBiB,QAA1C,CAAH,EAAwD;AACpD,UAAO,IAAP;AACH;AACJ;AACD,QAAO,KAAP;AAEH,CAfD;;AAiBA,IAAIC,gBAAgB,SAAhBA,aAAgB,GAAW;;AAE3B,KAAG,CAACnB,SAASC,aAAT,CAAuB,mBAAvB,CAAJ,EAAiD;AAC7C,SAAO,KAAP;AACH;;AAED,KAAIa,kBAAkB,CAAC,WAAD,EAAa,UAAb,EAAwB,WAAxB,EAAoC,YAApC,EAAiD,aAAjD,EAA+D,cAA/D,EAA8E,UAA9E,EAAyF,gBAAzF,EAA0G,WAA1G,EAAsH,YAAtH,EAAmI,cAAnI,EAAkJ,aAAlJ,EAAgK,WAAhK,EAA4K,YAA5K,EAAyL,WAAzL,EAAqM,cAArM,EAAoN,UAApN,EAA+N,aAA/N,EAA6O,YAA7O,EAA0P,aAA1P,EAAwQ,YAAxQ,EAAqR,aAArR,EAAmS,aAAnS,EAAiT,eAAjT,EAAiU,cAAjU,EAAgV,UAAhV,EAA2V,cAA3V,EAA0W,aAA1W,EAAwX,gBAAxX,EAAyY,eAAzY,EAAyZ,WAAzZ,EAAqa,YAAra,EAAkb,WAAlb,EAA8b,cAA9b,EAA6c,aAA7c,EAA2d,YAA3d,EAAwe,aAAxe,EAAsf,UAAtf,EAAigB,YAAjgB,EAA8gB,cAA9gB,EAA6hB,cAA7hB,EAA4iB,cAA5iB,EAA2jB,aAA3jB,EAAykB,aAAzkB,EAAulB,aAAvlB,EAAqmB,cAArmB,EAAonB,WAApnB,EAAgoB,gBAAhoB,EAAipB,aAAjpB,EAA+pB,eAA/pB,EAA+qB,WAA/qB,EAA2rB,eAA3rB,EAA2sB,cAA3sB,EAA0tB,UAA1tB,EAAquB,gBAAruB,EAAsvB,gBAAtvB,EAAuwB,YAAvwB,EAAoxB,eAApxB,EAAoyB,gBAApyB,EAAqzB,cAArzB,EAAo0B,aAAp0B,EAAk1B,iBAAl1B,CAAtB;;AAEA,MAAI,IAAIM,KAAK,CAAb,EAAgBA,KAAKN,gBAAgB9C,MAArC,EAA6CoD,IAA7C,EAAoD;AAChD,MAAIF,WAAWJ,gBAAgBM,EAAhB,CAAf;;AAEA,MAAIC,qBAAqB,CAAC,EAAD,EAAI,OAAJ,EAAY,MAAZ,EAAmB,WAAnB,EAA+B,OAA/B,CAAzB;AACA,OAAI,IAAIC,KAAK,CAAb,EAAgBA,KAAKD,mBAAmBrD,MAAxC,EAAgDsD,IAAhD,EAAsD;AAClD,OAAIC,KAAKF,mBAAmBC,EAAnB,CAAT;AACA,OAAGtB,SAASC,aAAT,CAAuB,yBAAuBsB,EAAvB,GAA0BL,QAAjD,CAAH,EAA+D;AAC3D,WAAO,IAAP;AACH;AACJ;AACJ;AACD,QAAO,KAAP;AAEH,CArBD;AAsBA,IAAIM,sBAAsB,SAAtBA,mBAAsB,CAAUC,mBAAV,EAA+BtB,UAA/B,EAA2CuB,MAA3C,EAAmDC,gBAAnD,EAAqE;;AAE3F,KAAI7E,IAAIQ,OAAOC,cAAf;;AAEA,KAAG,CAACkE,uBAAuBtB,UAAvB,IAAqCuB,MAArC,IAA+CC,gBAAhD,KAAqEC,SAAxE,EAAmF;;AAGnF,KAAIC,iCAAiCpD,OAAOqD,IAAP,CAAYL,mBAAZ,CAArC;AACA,KAAIM,qCAAqCjF,EAAE+E,8BAAF,EAAkCzE,MAAlC,CAAyC,UAAC4E,CAAD;AAAA,SAAO7B,WAAW6B,CAAX,CAAP;AAAA,EAAzC,EAA+DpE,KAA/D,EAAzC;AACA,KAAIqE,0CAA0CnF,EAAEiF,kCAAF,EAAsC3E,MAAtC,CAA6C,UAAC4E,CAAD;AAAA,SAAMP,oBAAoBO,CAApB,IAAuB,CAA7B;AAAA,EAA7C,EAA8EpE,KAA9E,EAA9C;AACA,KAAGN,OAAO4E,aAAV,EAAyBC,QAAQC,GAAR,CAAYX,mBAAZ;AACzB,KAAGnE,OAAO4E,aAAV,EAAyBC,QAAQC,GAAR,CAAYH,uCAAZ;;AAGzB,KAAII,8BAA8B5D,OAAOqD,IAAP,CAAYH,gBAAZ,CAAlC;AACA,KAAIW,kCAAkCxF,EAAEuF,2BAAF,EAA+BjF,MAA/B,CAAsC,UAAC4E,CAAD;AAAA,SAAON,OAAOM,CAAP,CAAP;AAAA,EAAtC,EAAwDpE,KAAxD,EAAtC;AACA,KAAI2E,uCAAuCzF,EAAEwF,+BAAF,EAAmClF,MAAnC,CAA0C,UAAC4E,CAAD;AAAA,SAAML,iBAAiBK,CAAjB,IAAoB,CAA1B;AAAA,EAA1C,EAAwEpE,KAAxE,EAA3C;AACA,KAAGN,OAAO4E,aAAV,EAAyBC,QAAQC,GAAR,CAAYT,gBAAZ;AACzB,KAAGrE,OAAO4E,aAAV,EAAyBC,QAAQC,GAAR,CAAYG,oCAAZ;AAC5B,CAnBD;;AA0BA,IAAIC,2BAA2B,SAA3BA,wBAA2B,CAASf,mBAAT,EAA8B;;AAEzD,KAAIA,mBAAD,IAAyBG,SAA5B,EAAuC;;AAEvC,KAAIa,mBAAmB,EAACC,OAAM,CAAP,EAASC,QAAO,EAAhB,EAAvB;AACA,KAAIvC,iBAAiB,CAAC,IAAD,EAAM,cAAN,EAAqB,kBAArB,EAAwC,OAAxC,EAAgD,YAAhD,EAA6D,iBAA7D,EAA+E,QAA/E,EAAwF,YAAxF,EAAqG,iBAArG,EAAuH,aAAvH,EAAqI,SAArI,EAA+I,MAA/I,EAAsJ,cAAtJ,EAAqK,uBAArK,EAA6L,aAA7L,EAA2M,MAA3M,EAAkN,UAAlN,EAA6N,OAA7N,EAAqO,eAArO,EAAqP,iBAArP,EAAuQ,OAAvQ,EAA+Q,YAA/Q,EAA4R,UAA5R,EAAuS,aAAvS,EAAqT,YAArT,EAAkU,cAAlU,EAAiV,SAAjV,EAA2V,aAA3V,EAAyW,WAAzW,EAAqX,WAArX,EAAiY,eAAjY,EAAiZ,OAAjZ,EAAyZ,QAAzZ,EAAka,YAAla,EAA+a,MAA/a,EAAsb,MAAtb,EAA6b,YAA7b,EAA0c,QAA1c,EAAmd,cAAnd,EAAke,gBAAle,EAAmf,aAAnf,EAAigB,eAAjgB,EAAihB,aAAjhB,EAA+hB,aAA/hB,EAA6iB,WAA7iB,EAAyjB,eAAzjB,EAAykB,iBAAzkB,EAA2lB,uBAA3lB,EAAmnB,eAAnnB,EAAmoB,KAAnoB,EAAyoB,iBAAzoB,EAA2pB,aAA3pB,EAAyqB,aAAzqB,EAAurB,cAAvrB,EAAssB,SAAtsB,EAAgtB,UAAhtB,EAA2tB,SAA3tB,EAAquB,OAAruB,EAA6uB,KAA7uB,EAAmvB,YAAnvB,EAAgwB,WAAhwB,EAA4wB,OAA5wB,EAAoxB,YAApxB,EAAiyB,gBAAjyB,EAAkzB,WAAlzB,EAA8zB,WAA9zB,EAA00B,cAA10B,EAAy1B,UAAz1B,EAAo2B,YAAp2B,EAAi3B,gBAAj3B,EAAk4B,0CAAl4B,EAA66B,eAA76B,EAA67B,iBAA77B,EAA+8B,QAA/8B,EAAw9B,eAAx9B,EAAw+B,YAAx+B,EAAq/B,gBAAr/B,EAAsgC,qBAAtgC,EAA4hC,oBAA5hC,EAAijC,qBAAjjC,EAAukC,cAAvkC,EAAslC,6BAAtlC,EAAonC,gBAApnC,EAAqoC,aAAroC,EAAmpC,aAAnpC,EAAiqC,cAAjqC,EAAgrC,WAAhrC,EAA4rC,WAA5rC,EAAwsC,SAAxsC,EAAktC,SAAltC,EAA4tC,WAA5tC,EAAwuC,YAAxuC,EAAqvC,kBAArvC,EAAwwC,eAAxwC,EAAwxC,cAAxxC,EAAuyC,UAAvyC,EAAkzC,WAAlzC,EAA8zC,WAA9zC,EAA00C,YAA10C,EAAu1C,SAAv1C,EAAi2C,eAAj2C,EAAi3C,gBAAj3C,EAAk4C,UAAl4C,EAA64C,UAA74C,EAAw5C,kBAAx5C,EAA26C,cAA36C,EAA07C,MAA17C,EAAi8C,wCAAj8C,EAA0+C,YAA1+C,EAAu/C,WAAv/C,EAAmgD,SAAngD,EAA6gD,cAA7gD,EAA4hD,aAA5hD,EAA0iD,UAA1iD,EAAqjD,WAArjD,EAAikD,SAAjkD,EAA2kD,mBAA3kD,EAA+lD,kBAA/lD,EAAknD,mBAAlnD,EAAsoD,qBAAtoD,EAA4pD,sBAA5pD,EAAmrD,gBAAnrD,EAAosD,SAApsD,EAA8sD,YAA9sD,EAA2tD,WAA3tD,EAAuuD,MAAvuD,EAA8uD,cAA9uD,EAA6vD,QAA7vD,EAAswD,gBAAtwD,EAAuxD,cAAvxD,EAAsyD,UAAtyD,EAAizD,QAAjzD,EAA0zD,eAA1zD,EAA00D,YAA10D,EAAu1D,eAAv1D,EAAu2D,iBAAv2D,EAAy3D,YAAz3D,EAAs4D,gBAAt4D,EAAu5D,YAAv5D,EAAo6D,UAAp6D,EAA+6D,WAA/6D,EAA27D,aAA37D,EAAy8D,aAAz8D,EAAu9D,WAAv9D,EAAm+D,YAAn+D,EAAg/D,UAAh/D,EAA2/D,WAA3/D,EAAugE,wCAAvgE,EAAgjE,SAAhjE,EAA0jE,kBAA1jE,EAA6kE,QAA7kE,EAAslE,WAAtlE,EAAkmE,kBAAlmE,EAAqnE,KAArnE,EAA2nE,cAA3nE,EAA0oE,SAA1oE,EAAopE,YAAppE,EAAiqE,SAAjqE,EAA2qE,mBAA3qE,EAA+rE,MAA/rE,EAAssE,UAAtsE,EAAitE,MAAjtE,EAAwtE,oBAAxtE,EAA6uE,iBAA7uE,EAA+vE,UAA/vE,EAA0wE,SAA1wE,EAAoxE,aAApxE,EAAkyE,WAAlyE,EAA8yE,KAA9yE,EAAozE,YAApzE,EAAi0E,WAAj0E,EAA60E,WAA70E,EAAy1E,cAAz1E,EAAw2E,UAAx2E,EAAm3E,UAAn3E,EAA83E,YAA93E,EAA24E,SAA34E,EAAq5E,WAAr5E,EAAi6E,WAAj6E,EAA66E,UAA76E,EAAw7E,WAAx7E,EAAo8E,gCAAp8E,EAAq+E,SAAr+E,EAA++E,YAA/+E,EAA4/E,YAA5/E,EAAygF,SAAzgF,EAAmhF,WAAnhF,EAA+hF,WAA/hF,EAA2iF,eAA3iF,EAA2jF,iBAA3jF,EAA6kF,aAA7kF,EAA2lF,qBAA3lF,EAAinF,gBAAjnF,EAAkoF,SAAloF,EAA4oF,UAA5oF,EAAupF,QAAvpF,EAAgqF,MAAhqF,EAAuqF,UAAvqF,EAAkrF,QAAlrF,EAA2rF,OAA3rF,EAAmsF,QAAnsF,EAA4sF,WAA5sF,EAAwtF,eAAxtF,EAAwuF,4BAAxuF,EAAqwF,MAArwF,EAA4wF,iBAA5wF,EAA8xF,kBAA9xF,EAAizF,iBAAjzF,EAAm0F,iBAAn0F,EAAq1F,QAAr1F,EAA81F,cAA91F,EAA62F,aAA72F,EAA23F,OAA33F,EAAm4F,4BAAn4F,EAAg6F,qBAAh6F,EAAs7F,yBAAt7F,EAAg9F,qBAAh9F,EAAs+F,qBAAt+F,EAA4/F,iBAA5/F,EAA8gG,MAA9gG,EAAqhG,aAArhG,EAAmiG,aAAniG,EAAijG,mBAAjjG,EAAqkG,iBAArkG,EAAulG,cAAvlG,EAAsmG,gBAAtmG,EAAunG,gBAAvnG,EAAwoG,aAAxoG,EAAspG,UAAtpG,EAAiqG,cAAjqG,EAAgrG,YAAhrG,EAA6rG,kBAA7rG,EAAgtG,WAAhtG,EAA4tG,MAA5tG,EAAmuG,mBAAnuG,EAAuvG,UAAvvG,EAAkwG,SAAlwG,EAA4wG,WAA5wG,EAAwxG,eAAxxG,EAAwyG,WAAxyG,EAAozG,cAApzG,EAAm0G,iBAAn0G,EAAq1G,aAAr1G,EAAm2G,cAAn2G,EAAk3G,gBAAl3G,EAAm4G,kBAAn4G,EAAs5G,WAAt5G,EAAk6G,QAAl6G,EAA26G,YAA36G,EAAw7G,aAAx7G,EAAs8G,aAAt8G,EAAo9G,eAAp9G,EAAo+G,eAAp+G,EAAo/G,YAAp/G,CAArB;AACA,MAAI,IAAIwC,KAAK,CAAb,EAAgBA,KAAKxC,eAAepC,MAApC,EAA4C4E,IAA5C,EAAkD;AAC9C,MAAIZ,IAAI5B,eAAewC,EAAf,CAAR;AACAC,2BAAyBb,CAAzB;AACAa,2BAAyB,QAAMb,CAA/B;AACH;AACD,QAAOS,gBAAP;;AAEA,UAASI,wBAAT,CAAkCb,CAAlC,EAAqC;AACjC,MAAIU,QAAQjB,oBAAoBO,CAApB,CAAZ,CAAoC,IAAG,CAACU,KAAJ,EAAW;AAC/CD,mBAAiBC,KAAjB,IAA0BA,KAA1B;AACAD,mBAAiBE,MAAjB,CAAwBX,CAAxB,IAA2BU,KAA3B;AACH;AAEJ,CAnBD;AAoBA,SAASI,WAAT,CAAqBC,OAArB,EAA8BtB,mBAA9B,EAAmDtB,UAAnD,EAA+DuB,MAA/D,EAAuEC,gBAAvE,EAAyFqB,UAAzF,EAAqG;AAGjGxB,qBAAoBC,mBAApB,EAAyCtB,UAAzC,EAAqDuB,MAArD,EAA6DC,gBAA7D;AACAa,0BAAyBf,mBAAzB;AACAsB,SAAQE,aAAR,GAAwB,CAAC,CAAC3F,OAAO4F,UAAjC;AACAH,SAAQI,sBAAR,GAAiCX,yBAAyBrC,UAAzB,CAAjC;AACH4C,SAAQK,sBAAR,GAAiCZ,yBAAyBf,mBAAzB,CAAjC;;AAGGsB,SAAQM,YAAR,GAAuB,CAAC,EAAE,CAAC/F,OAAOgG,MAAP,IAAehG,OAAOiG,CAAvB,KAA6B,CAACjG,OAAOgG,MAAP,IAAehG,OAAOiG,CAAvB,EAA0BC,EAAvD,IAA6D,CAAClG,OAAOgG,MAAP,IAAehG,OAAOiG,CAAvB,EAA0BC,EAA1B,CAA6BC,KAA5F,CAAD,GAAoG,CAA3H;AACAV,SAAQW,qBAAR,GAAgCxD,4BAA4BC,UAA5B,CAAhC;AACA4C,SAAQY,qBAAR,GAAgCjD,4BAA4BP,UAA5B,CAAhC;AACA4C,SAAQa,sBAAR,GAAiChD,6BAA6BT,UAA7B,CAAjC;AACA4C,SAAQc,sBAAR,GAAiClD,6BAA6BR,UAA7B,CAAjC;AACA4C,SAAQe,0BAAR,GAAqC5D,4BAA4B8C,UAA5B,CAArC;AACAD,SAAQgB,0BAAR,GAAqCrD,4BAA4BsC,UAA5B,CAArC;AACAD,SAAQiB,2BAAR,GAAsCpD,6BAA6BoC,UAA7B,CAAtC;AACAD,SAAQkB,2BAAR,GAAsCtD,6BAA6BqC,UAA7B,CAAtC;;AAGAD,SAAQmB,SAAR,GAAoBlD,mBAAiB,CAArC;;AAGA+B,SAAQoB,QAAR,GAAmBhD,kBAAgB,CAAnC;;AAGA4B,SAAQqB,YAAR,GAAuBrE,sBAAoB,CAA3C;;AAGAgD,SAAQsB,qBAAR,GAAgCxD,+BAA6B,CAA7D;;AAEA,QAAOkC,OAAP;AACH;;AAOD,IAAIuB,yBAAyB,SAAzBA,sBAAyB,CAASnE,UAAT,EAAqB;;AAE9C,KAAIrD,IAAIQ,OAAOC,cAAf;AACH,KAAIF,SAASP,EAAEO,MAAF,CAASF,IAAT,CAAcL,CAAd,CAAb;;AAEG,KAAIsD,iBAAiB,CACjB,UADiB,EACN,OADM,CAArB;;AAIA,QAAO/C,OAAO+C,cAAP,EAAuB,UAACpD,CAAD,EAAGyD,CAAH;AAAA,SAASzD,KAAGmD,WAAWM,CAAX,IAAc,CAAjB,CAAT;AAAA,EAAvB,EAAqD,CAArD,CAAP;AAEH,CAXD;;AAcA,IAAI8D,2BAA2B,SAA3BA,wBAA2B,CAASpE,UAAT,EAAqB;AAChD,KAAIrD,IAAIQ,OAAOC,cAAf;AACH,KAAIF,SAASP,EAAEO,MAAF,CAASF,IAAT,CAAcL,CAAd,CAAb;;AAEG,KAAIsD,iBAAiB,CACjB,MADiB,EACT,MADS,EACD,SADC,EACU,QADV,CAArB;;AAIA,QAAO/C,OAAO+C,cAAP,EAAuB,UAACpD,CAAD,EAAGyD,CAAH;AAAA,SAASzD,KAAGmD,WAAWM,CAAX,IAAc,CAAjB,CAAT;AAAA,EAAvB,EAAqD,CAArD,CAAP;AAEH,CAVD;AAWA,SAAS+D,eAAT,CAAyBzB,OAAzB,EAAkC5C,UAAlC,EAA8C6C,UAA9C,EAA0D;AACtDD,SAAQ0B,gBAAR,GAA2BH,uBAAuBnE,UAAvB,CAA3B;AACH4C,SAAQ2B,kBAAR,GAA6BH,yBAAyBpE,UAAzB,CAA7B;AACG4C,SAAQ4B,qBAAR,GAAgCL,uBAAuBtB,UAAvB,CAAhC;AACAD,SAAQ6B,uBAAR,GAAkCL,yBAAyBvB,UAAzB,CAAlC;;AAEA,QAAOD,OAAP;AACH;AACD,KAAK,YAAW;;AAEZzF,QAAOuH,SAAP,GAAmB,EAAnB;;AAKAvH,QAAOuH,SAAP,CAAiBC,WAAjB,GAA+B,UAAUC,OAAV,EAAmB;AAG9C,MAAGA,mBAAmBC,kBAAtB,EAA0C;AACtC;AACH;;AAED,MAAIC,OAAOF,QAAQG,QAAnB;;AAEA,MAAIC,OAAOC,iBAAiBD,IAAjB,KAA0BC,iBAAiBD,IAAjB,GAAwB,EAAlD,CAAX;AACA,MAAIE,MAAMF,KAAKF,IAAL,MAAeE,KAAKF,IAAL,IAAa,CAA5B,CAAV;AACAE,OAAKF,IAAL;;AAEAK,gBAAcP,OAAd,EAAuBE,IAAvB;AACH,EAdD;;AAgBA,UAASK,aAAT,CAAuBP,OAAvB,EAAgCE,IAAhC,EAAsC;AAClC,OAAI,IAAIhH,IAAI,CAAZ,EAAeA,IAAI8G,QAAQQ,UAAR,CAAmBvH,MAAtC,EAA8CC,GAA9C,EAAmD;AAC/C,OAAIuH,MAAMT,QAAQQ,UAAR,CAAmBtH,CAAnB,CAAV;;AAEA,OAAGwH,iBAAiBV,OAAjB,EAA0BS,IAAIN,QAA9B,CAAH,EAA4C;AACxC,QAAIK,aAAaH,iBAAiBG,UAAjB,KAAgCH,iBAAiBG,UAAjB,GAA8B,EAA9D,CAAjB;AACA,QAAIG,YAAYH,WAAWC,IAAIN,QAAf,MAA6BK,WAAWC,IAAIN,QAAf,IAA2B,EAAxD,CAAhB;AACA,QAAIS,eAAeD,UAAUT,IAAV,MAAoBS,UAAUT,IAAV,IAAkB,EAACvC,OAAO,CAAR,EAAtC,CAAnB;AACAiD,iBAAajD,KAAb;AACH;AACJ;AACJ;;AAED,UAAS+C,gBAAT,CAA0BV,OAA1B,EAAmCa,OAAnC,EAA4C;AAExC,MAAGA,WAAW,OAAd,EAAuB;AACnBA,aAAU,WAAV;AACH;;AAED,MAAGA,WAAW,WAAd,EAA2B;AACvB,UAAO,KAAP;AACH;;AAGD,MAAGA,QAAQhG,OAAR,CAAgB,OAAhB,KAA4B,CAAC,CAAhC,EAAmC;AAC/B,UAAO,KAAP;AACH;;AAMD,SAAO,IAAP;AACH;AACJ,CAzDI,EAAL;AA0DA,KAAK,YAAW;AAAE,KAAI;;AAErB,MAAI9C,IAAIQ,OAAOC,cAAf;AACA,MAAIL,MAAMJ,EAAEI,GAAF,CAAMC,IAAN,CAAWL,CAAX,CAAV;AACA,MAAIG,YAAYH,EAAEG,SAAF,GAAcH,EAAEG,SAAhB,GAA4BC,GAA5C;AACA,MAAIG,SAASP,EAAEO,MAAF,CAASF,IAAT,CAAcL,CAAd,CAAb;AACA,MAAIM,SAASN,EAAEM,MAAF,CAASD,IAAT,CAAcL,CAAd,CAAb;;AAEA,MAAI+I,gBAAgBC,UAAUC,SAAV,CAAoBnG,OAApB,CAA4B,MAA5B,KAAqC,CAAzD;AACA,MAAIoG,mBAAmBF,UAAUC,SAAV,CAAoBnG,OAApB,CAA4B,SAA5B,KAAwC,CAA/D;;AAKA,OAAK,YAAW;AAGf,OAAIqG,IAAIC,QAAJ,CAAaC,IAAb,KAAsBD,SAASC,IAAnC,EAAyC,MAAM,IAAIC,KAAJ,CAAU,oDAAV,CAAN;;AAGzC,OAAI9I,OAAO+I,QAAX,EAAqB,MAAM,IAAID,KAAJ,CAAU,mIAAV,CAAN;;AAGrB,OAAI,CAAC9I,OAAOC,cAAZ,EAA4B,MAAM,IAAI6I,KAAJ,CAAU,6CAAV,CAAN;;AAE5B,OAAI,CAAC9I,OAAOuH,SAAZ,EAAuB,MAAM,IAAIuB,KAAJ,CAAU,wCAAV,CAAN;;AAGvB,OAAG,CAAC,KAAGE,OAAOC,SAAP,CAAiBC,IAArB,EAA2B5G,OAA3B,CAAmC,eAAnC,KAAuD,CAAC,CAA3D,EAA8D;AAC7DuC,YAAQsE,IAAR,CAAa,kFAAb;AACAH,WAAOC,SAAP,CAAiBC,IAAjB,GAAwB,YAAW;AAClC,YAAO,KAAKE,OAAL,CAAa,YAAb,EAA2B,EAA3B,CAAP;AACA,KAFD;AAGA;AAED,GArBI,EAAL;;AA0BA,OAAK,YAAW;AACfpJ,UAAO8H,gBAAP,GAA0B;AAEzBD,UAAM,EAFmB;AAOzBI,gBAAY,EAPa,EAA1B;;AAeAjI,UAAOqJ,aAAP,GAAuB,EAAvB;AACArJ,UAAOsJ,OAAP,GAAiB;AAChBC,aAAS;AADO,IAAjB;;AAIAvJ,UAAO+I,QAAP,GAAkB,EAAlB;AACA/I,UAAOwJ,eAAP,GAAyB;AAGxBC,WAAO,CAAE,CAAF,EAAI,CAAJ,EAAM,CAAN,EAAQ,CAAR,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAoB,CAApB,EAAsB,CAAtB,EAAwB,CAAxB,EAA0B,CAA1B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,CAHiB;AAwBxBC,WAAOvI,OAAOC,MAAP,CAAc,IAAd,CAxBiB;AAoCxBuI,YAAQ,EAAC,oBAAmB,CAApB,EApCgB;;AAuCxBC,WAAO,EAAC,cAAa,CAAd,EAAgB,WAAU,CAA1B,EAA4B,WAAU,CAAtC,EAvCiB,EAAzB;AAqDA,GA3EI,EAAL;;AAgFA,OAAK,YAAW;AAAE;;AAEjBb,YAASc,WAAT,GAAuB;AAItBC,mBAAe,EAJO;;AAQtBC,sBAAkB,EARI;;AAUtBC,kBAAc,EAVQ;AAWtBC,gBAAY,KAXU;;AActBC,uBAAmBA,iBAdG;AAetBC,yBAAqBA,mBAfC;;AAkBtBC,0BAAsB,CAlBA;AAmBtBC,6BAAyB,CAnBH;AAoBtBC,uBAAmB;AApBG,IAAvB;;AAuBA,OAAIC,2BAA2B,KAA/B;;AAEA,OAAIC,YAAYrJ,OAAOC,MAAP,CAAc,IAAd,CAAhB;;AAMA,YAAS8I,iBAAT,GAA6B;AAC5B,QAAIO,cAAc/H,SAAS+H,WAA3B;;AAGA,SAAK,IAAIC,UAAUD,YAAY/J,MAA/B,EAAuCgK,SAAvC,GAAmD;AAClD,SAAIC,aAAaF,YAAYC,OAAZ,CAAjB;AACA,SAAI;AACH,UAAGC,WAAWC,QAAd,EAAwB;AACvBC,wBAAiBF,WAAWC,QAA5B,EAAsCD,UAAtC;AACA,OAFD,MAEO;AACN9F,eAAQsE,IAAR,CAAa,oCAAb,EAAmDwB,WAAW9B,IAAX,IAAiB8B,UAApE;AACA;AACD,MAND,CAOA,OAAOG,CAAP,EAAU;AACTjG,cAAQC,GAAR,CAAYgG,CAAZ,EAAeA,EAAEC,KAAjB;AACA;AACD;;AAID,QAAIC,aAAa,CAACxB,gBAAgBE,KAAhB,CAAsB,gBAAtB,KAAyC,EAA1C,EAA8CrE,MAA9C,IAAsD,EAAvE;AACA,SAAI,IAAI4F,SAAR,IAAqBT,SAArB,EAAgC;AAC/B,SAAIU,WAAWV,UAAUS,SAAV,CAAf;AACA,SAAIE,aAAaH,WAAWC,SAAX,IAAsB,CAAvC;AACA,SAAIG,eAAeC,UAAUF,UAAV,EAAsB,UAACxK,CAAD;AAAA,aAAM,EAAC2K,SAAQ,gBAAcL,SAAd,GAAwB,IAAxB,GAA6BtK,CAA7B,GAA+B,GAAxC,EAAN;AAAA,MAAtB,CAAnB;AACA4K,iBAAYL,QAAZ,EAAsBE,YAAtB;AACA;AAED;;AAMD,YAASP,gBAAT,CAA0CD,QAA1C,EAAoDD,UAApD,EAAgEa,qBAAhE,EAAuF;AACtF,SAAK,IAAIC,YAAYb,SAASlK,MAA9B,EAAsC+K,WAAtC,GAAoD;AAGnD,SAAIC,OAAOd,SAASa,SAAT,CAAX;;AAIA,SAAGC,KAAKC,IAAL,IAAa,CAAhB,EAAmB;AAClBnB,gBAAUkB,KAAKE,IAAf,IAAuBF,IAAvB;AACA;AACA;;AAGD,SAAGA,KAAKC,IAAL,IAAa,EAAb,KAAoB,CAACE,IAAIC,QAAL,IAAiB,CAACD,IAAIC,QAAJ,CAAaJ,KAAKK,aAAlB,CAAtC,CAAH,EAA4E;AAC3E;AACA;;AAGDR,iBAAYG,IAAZ,EAAiBF,qBAAjB;AAGA;AACD;;AAOD,YAASD,WAAT,CAAqBG,IAArB,EAA2BF,qBAA3B,EAAkD;AAGjDhC,oBAAgBC,KAAhB,CAAsBiC,KAAKC,IAAL,GAAU,CAAhC;;AAGA,QAAID,KAAKd,QAAL,IAAiBc,KAAKd,QAAL,CAAclK,MAAd,GAAqB,CAA1C,EAA6C;;AAE5CmK,sBAAiBa,KAAKd,QAAtB,EAAgCc,KAAKM,gBAArC,EAAuDR,qBAAvD;AAEA;;AAGD,QAAGE,KAAKO,KAAR,EAAe;AAGd,SAAIC,YAAJ;AACA,SAAIC,eAAJ;AACA,SAAGT,KAAKQ,YAAR,EAAsB;AACrBA,qBAAenD,SAASqD,sBAAT,CAAgCC,iBAAhC,CAAkDX,KAAKQ,YAAvD,CAAf;AACA,UAAI;AACH,WAAGV,qBAAH,EAA0B;AACzBW,0BAAkB,GAAGG,KAAH,CAAS/J,IAAT,CAAcG,SAAS6J,gBAAT,CAA0BL,YAA1B,CAAd,CAAlB;AACAC,wBAAgBX,qBAAhB,GAAwCA,qBAAxC;AACA,QAHD,MAGO;AACNW,0BAAkB,GAAGG,KAAH,CAAS/J,IAAT,CAAcG,SAAS6J,gBAAT,CAA0BL,YAA1B,CAAd,CAAlB;AACA;AACD,OAPD,CAOE,OAAMM,EAAN,EAAU;AACXL,yBAAkB,EAAlB;AACAtH,eAAQsE,IAAR,CAAaqD,GAAGzB,KAAH,IAAW,uBAAqBmB,YAArB,GAAkC,UAAlC,GAA6CR,KAAKQ,YAA1E;AACA;AACD,MAbD,MAaO;AACNA,qBAAe,aAAWR,KAAKC,IAA/B;AACA,UAAGH,qBAAH,EAA0B;AACzBW,yBAAkBX,qBAAlB;AACA,OAFD,MAEO;AACNW,yBAAkB,EAAlB;AACA;AACD;;AAGDM,sBAAiBf,KAAKO,KAAtB,EAA6BC,YAA7B,EAA2CC,eAA3C,EAA4DT,KAAKC,IAAjE;AAEA;AACD;;AAOD,YAASxB,mBAAT,CAA6BuC,GAA7B,EAAkCC,KAAlC,EAAyC;AACxC,QAAI3C,eAAejB,SAASc,WAAT,CAAqBG,YAAxC;AACA0C,UAAMA,OAAOhK,SAASkK,eAAtB,CAAuCD,QAAQA,QAAM,CAAd;;AAGvC,QAAIE,WAAW,GAAGP,KAAH,CAAS/J,IAAT,CAAcG,SAASoK,GAAvB,EAA2B,CAA3B,CAAf;AACA,SAAI,IAAInM,IAAI,CAAZ,EAAeA,IAAIkM,SAASnM,MAA5B,EAAoCC,GAApC,EAAyC;AACxC,SAAI8G,UAAQoF,SAASlM,CAAT,CAAZ;;AAGA,SAAG,CAACoI,SAASc,WAAT,CAAqBI,UAAzB,EAAqC;AAEpC8C,0BAAoBtF,OAApB,EAA6BkF,KAA7B;;AAEA,UAAIlF,QAAQuF,YAAR,CAAqB,OAArB,CAAJ,EAAmC;AAElC,WAAIC,WAAW,CAAf;AACA,WAAIC,WAAW,IAAf;AACA,WAAIhB,eAAe,aAAWzE,QAAQ6D,OAAtC;AACA,WAAIa,kBAAkB,CAAC1E,OAAD,CAAtB;AACAgF,wBAAiBhF,QAAQwE,KAAzB,EAAgCC,YAAhC,EAA8CC,eAA9C,EAA+Dc,QAA/D,EAAyEC,QAAzE;AACA;AACD,MAZD,MAYO;AACN,WAAI,IAAIC,IAAI,CAAZ,EAAeA,IAAInD,aAAatJ,MAAhC,EAAyCyM,GAAzC,EAA8C;AAC7C,WAAIC,cAAcpD,aAAamD,CAAb,CAAlB;AACA,WAAI1H,UAAU4D,cAAc+D,YAAYxB,IAA1B,MAAoCvC,cAAc+D,YAAYxB,IAA1B,IAAgC,EAApE,CAAd;AACAwB,mBAAY3F,OAAZ,EAAqBhC,OAArB,EAA8B,IAA9B;AACA;AACD;AACD;AAED;;AAKD,YAASgH,gBAAT,CAA0BR,KAA1B,EAAiCC,YAAjC,EAA+CC,eAA/C,EAAgER,IAAhE,EAAsEuB,QAAtE,EAAgF;AAG/E,QAAGA,QAAH,EAAa;AACZnE,cAASc,WAAT,CAAqBO,oBAArB;AACA,KAFD,MAEO;AACNrB,cAASc,WAAT,CAAqBS,iBAArB;AACA;;AAGD,SAAI,IAAI3J,IAAI,CAAZ,EAAeA,IAAIoI,SAASc,WAAT,CAAqBC,aAArB,CAAmCpJ,MAAtD,EAA8DC,GAA9D,EAAmE;AAClE,SAAI0M,cAActE,SAASc,WAAT,CAAqBC,aAArB,CAAmCnJ,CAAnC,CAAlB;AACA0M,iBAAYpB,KAAZ,EAAmBC,YAAnB,EAAiCC,eAAjC,EAAkDR,IAAlD,EAAwDuB,QAAxD;AACA;AAED;;AAKD,YAASH,mBAAT,CAA6BtF,OAA7B,EAAsCkF,KAAtC,EAA6CW,KAA7C,EAAoD;AACnD,SAAI,IAAI3M,IAAI,CAAZ,EAAeA,IAAIoI,SAASc,WAAT,CAAqBE,gBAArB,CAAsCrJ,MAAzD,EAAiEC,GAAjE,EAAsE;AACrE,SAAI0M,cAActE,SAASc,WAAT,CAAqBE,gBAArB,CAAsCpJ,CAAtC,CAAlB;AACA0M,iBAAY5F,OAAZ,EAAqBkF,KAArB,EAA4BW,KAA5B;AACA;AACD;;AAKD,YAASjC,SAAT,CAAmB3K,MAAnB,EAA2B6M,WAA3B,EAAwC;AACvC,QAAIrN,QAAQO,MAAMC,MAAN,CAAZ;AACA,SAAI,IAAIC,IAAID,MAAZ,EAAoBC,GAApB,GAA0B;AACzBT,WAAMS,CAAN,IAAW4M,YAAY5M,CAAZ,CAAX;AACA;AACD,WAAOT,KAAP;AACA;AACD,GA7NI,EAAL;;AAkOA,OAAK,YAAW;;AAEf6I,YAASyE,SAAT,GAAqB;AACpBC,sBAAkBA,gBADE;AAEpBC,iBAAaA,WAFO;AAGpBC,oBAAgBF;AAHI,IAArB;;AAUA,YAASC,WAAT,CAAqBpN,KAArB,EAA2BsN,YAA3B,EAAyC;AAGxCtN,YAAQA,MAAM4I,IAAN,EAAR;;AAGA5I,YAAQA,MAAMuN,WAAN,EAAR;;AAGA,QAAIC,eAAexN,KAAf,CAAJ,EAA2B;AAAE,YAAO,iBAAP;AAA2B;AACxDA,YAAQA,MAAM8I,OAAN,CAAc,kBAAd,EAAkC,SAAlC,CAAR;;AAGA,QAAI2E,UAAU,CAAC,MAAD,EAAQ,KAAR,EAAc,KAAd,EAAoB,OAApB,EAA4B,MAA5B,EAAmC,MAAnC,EAA0C,KAA1C,EAAgD,OAAhD,EAAwD,OAAxD,EAAgE,MAAhE,CAAd;AACAzN,YAAQA,MAAM8I,OAAN,CACP,6CADO,EAEP;AAAA,YAAG2E,QAAQhO,MAAR,CACF,UAACiO,CAAD,EAAGC,IAAH,EAAQC,IAAR;AAAA,aAAeF,EAAE5E,OAAF,CAAU+E,OAAOD,IAAP,EAAY,GAAZ,CAAV,EAA2BD,IAA3B,CAAf;AAAA,MADE,EAEFpN,CAFE,CAAH;AAAA,KAFO,CAAR;;AASAP,YAAQA,MAAM8I,OAAN,CAAc,iHAAd,EAAiI,IAAjI,CAAR;AACA9I,YAAQA,MAAM8I,OAAN,CAAc,oEAAd,EAAoF,WAApF,CAAR;AACA9I,YAAQA,MAAM8I,OAAN,CAAc,0DAAd,EAA0E,WAA1E,CAAR;AACA9I,YAAQA,MAAM8I,OAAN,CAAc,sDAAd,EAAsE,WAAtE,CAAR;AACA9I,YAAQA,MAAM8I,OAAN,CAAc,yBAAd,EAAyC,SAAzC,CAAR;;AAGA9I,YAAQyN,QAAQhO,MAAR,CACP,UAACiO,CAAD,EAAGC,IAAH,EAAQC,IAAR;AAAA,YAAeF,EAAE5E,OAAF,CAAU+E,OAAOF,IAAP,EAAY,GAAZ,CAAV,EAA2BC,IAA3B,CAAf;AAAA,KADO,EAEP5N,KAFO,CAAR;;AAMAA,YAAQA,MAAM8I,OAAN,CAAc,YAAd,EAA4B,EAA5B,CAAR;;AAGA,YAAOwE,YAAP;AACC,UAAK,mBAAL;AACA,UAAK,eAAL;AAGCtN,cAAQA,MAAM8I,OAAN,CAAc,iBAAd,EAAgC,kBAAhC,CAAR;AACA;;AAED,UAAK,MAAL;AACA,UAAK,eAAL;AACA,UAAK,oBAAL;AACA,UAAK,uBAAL;AACA,UAAK,qBAAL;AAGC9I,cAAQA,MAAM8I,OAAN,CAAc,sBAAd,EAAqC,gBAArC,CAAR;AACA;;AAED,UAAK,OAAL;AAGC9I,cAAQA,MAAM8I,OAAN,CAAc,2FAAd,EAA2G,uBAA3G,CAAR;AACA9I,cAAQA,MAAM8I,OAAN,CAAc,2FAAd,EAA2G,uBAA3G,CAAR;AACA9I,cAAQA,MAAM8I,OAAN,CAAc,iFAAd,EAAiG,0BAAjG,CAAR;AACA9I,cAAQA,MAAM8I,OAAN,CAAc,iFAAd,EAAiG,0BAAjG,CAAR;AACA9I,cAAQA,MAAM8I,OAAN,CAAc,iFAAd,EAAiG,2BAAjG,CAAR;AACA9I,cAAQA,MAAM8I,OAAN,CAAc,iFAAd,EAAiG,2BAAjG,CAAR;AACA;;AA3BF;;AA+BA,WAAO9I,MAAM4I,IAAN,EAAP;AAEA;;AAOD,YAASuE,gBAAT,CAA0BnN,KAA1B,EAAiCsN,YAAjC,EAA+C;AAG9CtN,YAAQA,MAAM4I,IAAN,EAAR;;AAGA5I,YAAQA,MAAMuN,WAAN,EAAR;;AAGAvN,YAAQA,MAAM8I,OAAN,CAAc,4CAAd,EAA2D,EAA3D,CAAR;;AAGA,YAAOwE,YAAP;AACC,UAAK,aAAL;AAGC,UAAItN,MAAMgC,OAAN,CAAc,GAAd,KAAsB,CAAC,CAAvB,IAA4BhC,MAAMgC,OAAN,CAAc,GAAd,KAAsB,CAAC,CAAnD,IAAwDhC,MAAMgC,OAAN,CAAc,GAAd,CAA5D,EAAgF;AAC/EhC,eAAQA,MAAM8I,OAAN,CAAc,YAAd,EAA4B,EAA5B,CAAR;AACA;;AAGD9I,cAAQA,MAAM8N,KAAN,CAAY,UAAZ,CAAR;AACA,aAAO9N,KAAP;;AAED,UAAK,OAAL;AAGCA,cAAQA,MAAM8I,OAAN,CAAc,gCAAd,EAA+C,YAA/C,CAAR;AACA9I,cAAQA,MAAM8I,OAAN,CAAc,gCAAd,EAA+C,YAA/C,CAAR;;AAGA9I,cAAQA,MAAM8I,OAAN,CAAc,mGAAd,EAAmH,MAAnH,CAAR;AACA9I,cAAQA,MAAM8I,OAAN,CAAc,mGAAd,EAAmH,MAAnH,CAAR;;AAGA9I,cAAQA,MAAM8I,OAAN,CAAc,2FAAd,EAA2G,uBAA3G,CAAR;AACA9I,cAAQA,MAAM8I,OAAN,CAAc,2FAAd,EAA2G,uBAA3G,CAAR;AACA9I,cAAQA,MAAM8I,OAAN,CAAc,2FAAd,EAA2G,0BAA3G,CAAR;AACA9I,cAAQA,MAAM8I,OAAN,CAAc,2FAAd,EAA2G,0BAA3G,CAAR;AACA9I,cAAQA,MAAM8I,OAAN,CAAc,+GAAd,EAA+H,2BAA/H,CAAR;AACA9I,cAAQA,MAAM8I,OAAN,CAAc,+GAAd,EAA+H,2BAA/H,CAAR;;AAEA;;AAED;AAGC9I,cAAQA,MAAM8I,OAAN,CAAc,gCAAd,EAA+C,YAA/C,EACHA,OADG,CACK,gCADL,EACsC,YADtC,CAAR;;AAIA,UAAI9I,MAAMgC,OAAN,CAAc,GAAd,KAAsB,CAAC,CAA3B,EAA8B;AAC7BhC,eAAQA,MAAM8I,OAAN,CAAc,mGAAd,EAAmH,OAAnH,CAAR;AACA9I,eAAQA,MAAM8I,OAAN,CAAc,mGAAd,EAAmH,OAAnH,CAAR;AACA;;AA1CH;;AA+CA9I,YAAQA,MAAM4I,IAAN,GAAaE,OAAb,CAAqB,MAArB,EAA6B,GAA7B,CAAR;;AAGA9I,YAAQA,MAAM8N,KAAN,CAAY,sBAAZ,CAAR;;AAEA,WAAO9N,KAAP;AACA;;AAOD,YAASwN,cAAT,CAAwBO,cAAxB,EAAwC;AAGvC,QAAIC,iBAAiB,28CAArB;AACA,WAAOA,eAAeC,IAAf,CAAoBF,cAApB,CAAP;AAEA;AAED,GA3KI,EAAL;;AAgLA,OAAK,YAAW;;AAEftF,YAASqD,sBAAT,GAAkCoC,kBAAlC;AACAzF,YAASqD,sBAAT,CAAgCC,iBAAhC,GAAoDA,iBAApD;AACAtD,YAASqD,sBAAT,CAAgCqC,sBAAhC,GAAyDA,sBAAzD;AACA1F,YAASqD,sBAAT,CAAgCsC,QAAhC,GAA2CA,QAA3C;;AAGA,OAAIC,eAAeC,iBAAiBlM,SAASmM,aAAT,CAAuB,KAAvB,CAAjB,CAAnB;;AAEA,OAAIC,+BAA+B,SAA/BA,4BAA+B,GAAW;AAC7C,QAAIC,cAAcD,6BAA6BE,KAA/C;AACA,QAAGD,WAAH,EAAgB;AAAE,YAAOA,WAAP;AAAqB,KAAvC,MACK;AAAEA,mBAAc5N,OAAOC,MAAP,CAAc,IAAd,CAAd;AAAoC;;AAG3C,QAAGmH,aAAH,EAAkB;;AAEjBwG,iBAAY,GAAZ,IAAmB,CAAnB;AAGAA,iBAAY,uBAAZ,IAAuC,CAAvC;;AAeAA,iBAAY,+BAAZ,IAA+C,CAA/C;AACAA,iBAAY,iCAAZ,IAAiD,CAAjD;AACAA,iBAAY,kCAAZ,IAAkD,CAAlD;AACAA,iBAAY,gCAAZ,IAAgD,CAAhD;;AAKAA,iBAAY,yBAAZ,IAAyC,CAAzC;AACAA,iBAAY,2BAAZ,IAA2C,CAA3C;AACAA,iBAAY,4BAAZ,IAA4C,CAA5C;AACAA,iBAAY,0BAAZ,IAA0C,CAA1C;AACAA,iBAAY,0BAAZ,IAA0C,CAA1C;AACAA,iBAAY,uBAAZ,IAAuC,CAAvC;AACAA,iBAAY,sBAAZ,IAAsC,CAAtC;AACAA,iBAAY,4BAAZ,IAA4C,CAA5C;AACAA,iBAAY,8BAAZ,IAA8C,CAA9C;AACAA,iBAAY,8BAAZ,IAA8C,CAA9C;AACAA,iBAAY,oBAAZ,IAAoC,CAApC;;AAEAA,iBAAY,qBAAZ,IAAqC,CAArC;AAEA;;AAGD,QAAGrG,gBAAH,EAAqB;;AAEpBqG,iBAAY,GAAZ,IAAmB,CAAnB;AAEA;;AAGD5N,WAAOC,MAAP,CAAc2N,WAAd;;AAEA,WAAOD,6BAA6BE,KAA7B,GAAqCD,WAA5C;AAEA,IA9DD;AA+DA,OAAIE,4BAA4B,SAA5BA,yBAA4B,CAACC,OAAD,EAASC,GAAT,EAAaC,OAAb,EAAqB9O,KAArB,EAA+B;AAC9DA,YAAQA,MAAM4I,IAAN,GAAa2E,WAAb,EAAR;;AAGA,QAAIkB,cAAcD,8BAAlB;;AAGA,QAAIO,aAAaN,YAAYI,MAAI,GAAJ,GAAQ7O,KAApB,CAAjB;AACA,QAAG+O,eAAe,CAAlB,EAAqB;AAAE,YAAO,KAAP;AAAe;AACtC,QAAGA,eAAe,CAAf,KAAqB,CAACN,YAAY,GAAZ,CAAD,IAAqBvM,cAAcL,QAAd,CAAuBgN,GAAvB,EAA4BzO,MAA5B,IAAsC,CAAhF,CAAH,EAAuF;AAAE,YAAO,IAAP;AAAc;;AAGvG,QAAGyO,OAAKC,OAAR,EAAiB,OAAO,KAAP;;AAGjB,QAAI/J,SAAS/E,MAAM8N,KAAN,CAAY,cAAZ,CAAb;AACA,QAAIkB,cAAc,GAAlB;AACA,QAAIC,uBAAuB,IAAIpB,MAAJ,CAAW,MAAIiB,OAAJ,GAAY,kCAAvB,EAA0D,IAA1D,CAA3B;AACA,QAAI1N,KAAJ,CAAW,OAAMA,QAAQ6N,qBAAqBC,IAArB,CAA0BN,OAA1B,CAAd,EAAkD;AAC5DI,oBAAe5N,MAAM,CAAN,IAAW,GAA1B;AACA;AACD,SAAI,IAAIf,IAAI,CAAZ,EAAeA,IAAI0E,OAAO3E,MAA1B,EAAkCC,GAAlC,EAAuC;AACtC,SAAIL,QAAQ+E,OAAO1E,CAAP,CAAZ;AACA,SAAG2O,YAAYhN,OAAZ,CAAoB,MAAIhC,KAAJ,GAAU,GAA9B,KAAoC,CAAC,CAAxC,EAA2C,OAAO,KAAP;AAC3C;AACD,WAAO,IAAP;AAEA,IA3BD;;AA8BA,YAASkO,kBAAT,CAA4BvC,KAA5B,EAAmCC,YAAnC,EAAiDC,eAAjD,EAAkER,IAAlE,EAAwEuB,QAAxE,EAAkF;AAAEA,eAAS,CAAC,CAACA,QAAX;;AAGnF,QAAI9H,QAAQ+G,gBAAgBzL,MAA5B;AACA,QAAI+O,WAAWvD,YAAf;AACA,QAAIwD,cAAc,EAAC,UAAS,SAAV,EAAoB,WAAU,YAA9B,GAA4C,KAAG/D,IAAH,GAAQ,GAAR,GAAYuB,QAAxD,KAAmE,SAArF;;AAGA,QAAIyC,eAAgBvK,SAAS,CAA7B;AACA,QAAGuK,YAAH,EAAiB;AAChB5G,cAASc,WAAT,CAAqBQ,uBAArB;AACA;;AAGD,QAAIuF,uBACFF,eAAa,YAAd,GACG,CAACA,WAAD,EAAcG,MAAd,CAAqBpB,uBAAuBgB,QAAvB,CAArB,CADH,GAEG,CAACC,WAAD,EAAcD,QAAd,CAHJ;;AAOA,QAAIK,2BAA2BlQ,IAAIgQ,oBAAJ,EAA0B,UAACG,mBAAD;AAAA,YACxDvG,gBAAgBI,KAAhB,CAAsBmG,mBAAtB,MAA+CvG,gBAAgBI,KAAhB,CAAsBmG,mBAAtB,IAA6C,EAAC3K,OAAM,CAAP,EAASsE,OAAMvI,OAAOC,MAAP,CAAc,IAAd,CAAf,EAA5F,CADwD;AAAA,KAA1B,CAA/B;;AAKA,SAAI,IAAIT,IAAI,CAAZ,EAAeA,IAAImP,yBAAyBpP,MAA5C,EAAoDC,GAApD,EAAyD;AACxD,SAAIqP,0BAA0BF,yBAAyBnP,CAAzB,CAA9B;AACAqP,6BAAwB5K,KAAxB;AACA;;AAGD,QAAI8J,UAAU,MAAIjD,MAAMiD,OAAN,CAAcrB,WAAd,EAAlB;AACA,QAAGtF,aAAH,EAAkB;AACjB2G,eAAUA,QAAQ9F,OAAR,CAAgB,qCAAhB,EAAsD,eAAtD,CAAV;AACA8F,eAAUA,QAAQ9F,OAAR,CAAgB,sBAAhB,EAAuC,GAAvC,CAAV;AACA;;AAGD,SAAK,IAAIzI,IAAIsL,MAAMvL,MAAnB,EAA2BC,GAA3B,GAAiC;;AAEhC,SAAIwO,MAAMlD,MAAMtL,CAAN,CAAV;AAAA,SAAoBsP,eAAad,IAAI7M,OAAJ,CAAY,GAAZ,CAAjC;AAAA,SAAmD8M,UAAUa,gBAAc,CAAC,CAAf,GAAmBd,GAAnB,GAAyBA,IAAIe,MAAJ,CAAW,CAAX,EAAaD,YAAb,CAAtF;AACA,SAAIE,gBAAgBF,gBAAc,CAAd,IAAiBd,IAAI7M,OAAJ,CAAY,GAAZ,EAAgB,CAAhB,KAAoB,CAArC,GAAyC,OAAzC,GAAmD6M,GAAvE;AACA,SAAIiB,aAAanE,MAAMoE,gBAAN,CAAuBlB,GAAvB,CAAjB;;AAIA,SAAImB,iBAAiB,OAAOF,UAAP,KAAsB,QAAtB,IAAkCA,cAAc,EAAhD,IAAsDA,cAAc9L,SAAzF;AACA,SAAIgM,cAAJ,EAAoB;AACnB;AACA;;AAED,SAAIC,sBAAuBrB,QAAQ5M,OAAR,CAAgB,MAAI6M,GAAJ,GAAQ,GAAxB,KAAgC,CAAC,CAAlC,KAAyCiB,cAAY,SAAZ,IAAyB,CAACnB,0BAA0BC,OAA1B,EAAmCC,GAAnC,EAAwCC,OAAxC,EAAiDgB,UAAjD,CAAnE,CAA1B;AACA,SAAIG,mBAAJ,EAAyB;AACxB;AACA;;AAGD,SAAIC,uBAAuBzH,SAASyE,SAAT,CAAmBC,gBAAnB,CAAoC2C,UAApC,EAA+CD,aAA/C,CAA3B;AACA,SAAI9K,SAAS,IAAI5E,KAAJ,EAAb;AACA,UAAI,IAAIwC,IAAEuN,qBAAqB9P,MAA/B,EAAuCuC,GAAvC,GAA6C;AAC5CoC,aAAOpD,IAAP,CAAY8G,SAASyE,SAAT,CAAmBE,WAAnB,CAA+B8C,qBAAqBvN,CAArB,CAA/B,EAAuDkN,aAAvD,CAAZ;AACA;;AAGD,UAAI,IAAIM,KAAK,CAAb,EAAgBA,KAAKX,yBAAyBpP,MAA9C,EAAsD+P,IAAtD,EAA4D;AAC3D,UAAIT,0BAA0BF,yBAAyBW,EAAzB,CAA9B;;AAEA,UAAIC,YAAYV,wBAAwBtG,KAAxB,CAA8ByG,aAA9B,MAAiDH,wBAAwBtG,KAAxB,CAA8ByG,aAA9B,IAA+C,EAAC/K,OAAM,CAAP,EAASC,QAAOlE,OAAOC,MAAP,CAAc,IAAd,CAAhB,EAAhG,CAAhB;;AAGAsP,gBAAUtL,KAAV;;AAGA,WAAI,IAAI/E,IAAI,CAAZ,EAAeA,IAAIgF,OAAO3E,MAA1B,EAAkCL,GAAlC,EAAuC;AACtC,WAAIC,QAAQ+E,OAAOhF,CAAP,CAAZ;;AAEA,WAAGC,MAAMI,MAAN,GAAa,CAAhB,EAAmB;AAClBgQ,kBAAUrL,MAAV,CAAiB/E,KAAjB,IAA0B,CAACoQ,UAAUrL,MAAV,CAAiB/E,KAAjB,IAAwB,CAAzB,IAA8B,CAAxD;AACA;AAED;AAED;;AAGD,SAAG8E,QAAQ,CAAX,EAAc;AAGb,UAAIuL,aAAanH,gBAAgBE,KAAhB,CAAsByG,aAAtB,CAAjB;AACA,UAAI,CAACQ,UAAL,EAAiB;AAChBA,oBAAanH,gBAAgBE,KAAhB,CAAsByG,aAAtB,IAAuC;AACnD/K,eAAO,CAD4C;AAEnDC,gBAAQlE,OAAOC,MAAP,CAAc,IAAd;AAF2C,QAApD;AAIA;;AAGD,WAAI,IAAI0J,IAAI,CAAZ,EAAeA,IAAIqB,gBAAgBzL,MAAnC,EAA2CoK,GAA3C,EAAgD;AAC/C,WAAIrD,UAAU0E,gBAAgBrB,CAAhB,CAAd;;AAGA,WAAI8F,eAAenJ,QAAQsB,QAAR,KAAqBtB,QAAQsB,QAAR,GAAiB5H,OAAOC,MAAP,CAAc,IAAd,CAAtC,CAAnB;AACA,WAAIyP,cAAcD,aAAaT,aAAb,MAAgCS,aAAaT,aAAb,IAA8B,EAA9D,CAAlB;;AAIAU,mBAAYC,WAAZ,GAA0BD,YAAYC,WAAZ,KAA4BD,YAAYC,WAAZ,GAA0B,EAAtD,CAA1B;;AAEA,YAAI,IAAIC,KAAK,CAAb,EAAgBA,KAAKP,qBAAqB9P,MAA1C,EAAkDqQ,IAAlD,EAAwD;AACvD,YAAIC,YAAYR,qBAAqBO,EAArB,CAAhB;AACA,YAAGF,YAAYC,WAAZ,CAAwBxO,OAAxB,CAAgC0O,SAAhC,KAA8C,CAAC,CAAlD,EAAqD;AACpDH,qBAAYC,WAAZ,CAAwB7O,IAAxB,CAA6B+O,SAA7B;AACA;AACD;;AAGD,WAAGH,YAAYnQ,MAAZ,IAAsB,CAAzB,EAA4B;AAAEiQ,mBAAWvL,KAAX,IAAoB,CAApB;AAAwB;;AAGtD,YAAI,IAAI/E,IAAI,CAAZ,EAAeA,IAAIgF,OAAO3E,MAA1B,EAAkCL,GAAlC,EAAuC;AACtC,YAAIC,QAAQ+E,OAAOhF,CAAP,CAAZ;AACA,YAAGwQ,YAAYvO,OAAZ,CAAoBhC,KAApB,KAA8B,CAAjC,EAAoC;AAAE;AAAS;AAC/CqQ,mBAAWtL,MAAX,CAAkB/E,KAAlB,IAA2B,CAACqQ,WAAWtL,MAAX,CAAkB/E,KAAlB,IAAyB,CAA1B,IAA+B,CAA1D;AACAuQ,oBAAY5O,IAAZ,CAAiB3B,KAAjB;AACA;AAED;AAED;AAED;AACD;;AAED,YAASoO,QAAT,GAAoB;AAGnB,aAASuC,oBAAT,GAAgC;AAG/B,SAAGzH,gBAAgBE,KAAhB,CAAsB,gBAAtB,CAAH,EAA4C;AAC3CF,sBAAgBE,KAAhB,CAAsB,gBAAtB,EAAwCrE,MAAxC,GAAiD,EAAC,kBAAiBmE,gBAAgBE,KAAhB,CAAsB,gBAAtB,EAAwCtE,KAA1D,EAAjD;AACA;;AAGD,UAAI,IAAIqK,QAAR,IAAoBjG,gBAAgBI,KAApC,EAA2C;AAC1C,UAAI8B,OAAOlC,gBAAgBI,KAAhB,CAAsB6F,QAAtB,CAAX;AACA,UAAG/D,QAAQA,KAAKhC,KAAb,IAAsBgC,KAAKhC,KAAL,CAAW,gBAAX,CAAzB,EAAuD;AACtDgC,YAAKhC,KAAL,CAAW,gBAAX,EAA6BrE,MAA7B,GAAsC,EAAC,kBAAiBqG,KAAKhC,KAAL,CAAW,gBAAX,EAA6BtE,KAA/C,EAAtC;AACA;AACD;AAED;;AAED6L;AAEA;;AAUD,YAAS5E,iBAAT,CAA2B6E,IAA3B,EAAiC;AAChC,QAAGA,KAAK5O,OAAL,CAAa,GAAb,KAAqB,CAAC,CAAzB,EAA4B;AAC3B,YAAO4O,IAAP;AACA,KAFD,MAEO;AACN,YAAOA,KAAK9H,OAAL,CAAa,6GAAb,EAA4H,QAA5H,EAAsIA,OAAtI,CAA8I,mBAA9I,EAAkK,KAAlK,EAAyKA,OAAzK,CAAiL,WAAjL,EAA6L,KAA7L,EAAoMA,OAApM,CAA4M,4BAA5M,EAAyO,IAAzO,CAAP;AACA;AACD;;AAMD,YAASqF,sBAAT,CAAgCnO,KAAhC,EAAuC;AAGtCA,YAAQA,MAAM4I,IAAN,EAAR;;AAGA,QAAI5I,KAAJ,EAAW;AACVA,aAAQA,MAAM8I,OAAN,CAAc,MAAd,EAAsB,GAAtB,CAAR;AACA;;AAGD,QAAI9I,MAAMgC,OAAN,CAAc,GAAd,KAAsB,CAAC,CAA3B,EAA8B;AAC7BhC,aAAQA,MAAM8I,OAAN,CAAc,2FAAd,EAA2G,EAA3G,CAAR;AACA9I,aAAQA,MAAM8I,OAAN,CAAc,2FAAd,EAA2G,EAA3G,CAAR;AACA;;AAGD9I,YAAQA,MAAM8I,OAAN,CAAc,gCAAd,EAA+C,IAA/C,CAAR;AACA9I,YAAQA,MAAM8I,OAAN,CAAc,gCAAd,EAA+C,IAA/C,CAAR;;AAIA,QAAI9I,MAAMgC,OAAN,CAAc,GAAd,KAAsB,CAAC,CAA3B,EAA8B;AAC7BhC,aAAQA,MAAM8I,OAAN,CAAc,8CAAd,EAA8D,KAA9D,CAAR;AACA9I,aAAQA,MAAM8I,OAAN,CAAc,8CAAd,EAA8D,KAA9D,CAAR;AACA9I,aAAQA,MAAM8I,OAAN,CAAc,eAAd,EAA+B,KAA/B,CAAR;AACA;;AAGD,QAAI9I,MAAMgC,OAAN,CAAc,GAAd,KAAsB,CAAC,CAA3B,EAA8B;AAC7BhC,aAAQA,MAAM8I,OAAN,CAAc,8BAAd,EAA8C,IAA9C,CAAR;AACA;;AAGD,QAAI9I,MAAMgC,OAAN,CAAc,GAAd,KAAsB,CAAC,CAA3B,EAA8B;AAC7BhC,aAAQA,MAAM8I,OAAN,CAAc,8BAAd,EAA8C,IAA9C,CAAR;AACA;;AAGD9I,YAAQA,MAAM8I,OAAN,CAAc,oBAAd,EAAmC,MAAnC,CAAR;;AAGA9I,YAAQA,MAAM4I,IAAN,EAAR;;AAGA5I,YAAQA,MAAM8I,OAAN,CAAc,iBAAd,EAAgC,IAAhC,CAAR;;AAGA9I,YAAQ6Q,uBAAuB7Q,KAAvB,CAAR;;AAGAA,YAAQA,MAAM8N,KAAN,CAAY,UAAZ,CAAR;;AAEA,WAAO9N,KAAP;AAEA;;AAED,OAAI8Q,YAAY,MAAhB;AACA,OAAIC,eAAe,MAAnB;AACA,OAAIC,cAAc,SAAlB;AACA,OAAIC,gBAAgB,iCAApB;AACA,OAAIC,eAAe,CAGlB,IAAIrD,MAAJ,CAAW,MAAIkD,YAAJ,GAAiB,IAAjB,GAAsBD,SAAtB,GAAgC,GAA3C,EAA+C,GAA/C,CAHkB,EAIlB,IAAIjD,MAAJ,CAAW,MAAImD,WAAJ,GAAgB,IAAhB,GAAqBF,SAArB,GAA+B,GAA1C,EAA8C,GAA9C,CAJkB,EAKlB,IAAIjD,MAAJ,CAAW,MAAIoD,aAAJ,GAAkB,IAAlB,GAAuBH,SAAvB,GAAiC,GAA5C,EAAgD,GAAhD,CALkB,EAQlB,IAAIjD,MAAJ,CAAW,MAAImD,WAAJ,GAAgB,IAAhB,GAAqBD,YAArB,GAAkC,GAA7C,EAAiD,GAAjD,CARkB,EASlB,IAAIlD,MAAJ,CAAW,MAAIoD,aAAJ,GAAkB,IAAlB,GAAuBF,YAAvB,GAAoC,GAA/C,EAAmD,GAAnD,CATkB,EAYlB,IAAIlD,MAAJ,CAAW,MAAIoD,aAAJ,GAAkB,IAAlB,GAAuBD,WAAvB,GAAmC,GAA9C,EAAkD,GAAlD,CAZkB,CAAnB;AAiBA,YAASH,sBAAT,CAAgC7Q,KAAhC,EAAuC;;AAEtC,QAAImR,QAAJ,CAAc,GAAG;;AAEhBA,gBAAWnR,KAAX;AACA,UAAI,IAAIK,IAAI,CAAZ,EAAeA,IAAI6Q,aAAa9Q,MAAhC,EAAwCC,GAAxC,EAA6C;AAC5C,UAAI+Q,YAAYF,aAAa7Q,CAAb,CAAhB;AACAL,cAAQA,MAAM8I,OAAN,CAAcsI,SAAd,EAAwB,MAAxB,CAAR;AACA;AAED,KARa,QAQND,YAAYnR,KARN,EAQc,OAAOA,KAAP;AAE5B;AAED,GArXI,EAAL;;AA0XA,OAAK,YAAW;AAOf,OAAIqR,aAAaxQ,OAAOC,MAAP,CAAc,IAAd,CAAjB;AACA,OAAIyB,aAAa1B,OAAOC,MAAP,CAAc,IAAd,CAAjB;AACA,OAAIsE,aAAavE,OAAOC,MAAP,CAAc,IAAd,CAAjB;AACA,OAAIgD,SAASjD,OAAOC,MAAP,CAAc,IAAd,CAAb;AACA,OAAIwQ,SAASzQ,OAAOC,MAAP,CAAc,IAAd,CAAb;AAMA,OAAIiD,mBAAmBlD,OAAOC,MAAP,CAAc,IAAd,CAAvB;AACA,OAAI+C,sBAAsBhD,OAAOC,MAAP,CAAc,IAAd,CAA1B;AACA,OAAIyQ,6BAA6B,EAAjC;AACA,OAAIC,0BAA0B,EAA9B;AAKA,OAAIV,YAAY,8BAAhB;AACA,OAAIW,aAAa,6BAAjB;AACA,OAAIV,eAAe,8BAAnB;AACA,OAAIW,gBAAgB,6BAApB;AACA,OAAIT,gBAAgB,8BAApB;AACA,OAAIU,gBAAgB,6GAApB;AACA,OAAIC,mBAAmB,iFAAvB;AAMA,YAASC,cAAT,CAAwBC,OAAxB,EAAiC3C,QAAjC,EAA2C4C,QAA3C,EAAqD;AACpD,QAAIC,YAAY7C,SAAS/N,KAAT,CAAe0Q,OAAf,KAAyB,EAAzC;AACA,SAAI,IAAIzR,IAAI,CAAZ,EAAeA,IAAI2R,UAAU5R,MAA7B,EAAqCC,GAArC,EAA0C;AACzC,SAAI4R,WAAWD,UAAU3R,CAAV,CAAf;AACA4R,gBAAWA,SAASrC,MAAT,CAAgB,CAAhB,CAAX;AACAmC,cAASE,QAAT,IAAqB,CAACF,SAASE,QAAT,IAAmB,CAApB,IAAyB,CAA9C;AACA;AACD;;AAKDxJ,YAASyJ,gBAAT,GAA4B,SAASC,aAAT,CAAuBxG,KAAvB,EAA8ByG,aAA9B,EAA6C;AACxE,QAAG,OAAOA,aAAP,IAAwB,QAA3B,EAAqC;;AAErC,QAAIC,YAAYD,cAActE,KAAd,CAAoB,GAApB,CAAhB;AACA,SAAI,IAAIzN,IAAIgS,UAAUjS,MAAtB,EAA8BC,GAA9B,GAAoC;AAAE,SAAI8O,WAAWkD,UAAUhS,CAAV,CAAf;;AAGrCwR,oBAAef,SAAf,EAA0B3B,QAA1B,EAAoCmC,MAApC;AACAO,oBAAed,YAAf,EAA6B5B,QAA7B,EAAuC/J,UAAvC;AACAyM,oBAAeZ,aAAf,EAA8B9B,QAA9B,EAAwCkC,UAAxC;;AAGA,SAAGM,cAAc1D,IAAd,CAAmBkB,QAAnB,CAAH,EAAiC;AAChCqC,8BAAwB7P,IAAxB,CAA6BwN,QAA7B;AACA0C,qBAAeJ,UAAf,EAA2BtC,QAA3B,EAAqCpL,gBAArC;AACA;AACD,SAAG6N,iBAAiB3D,IAAjB,CAAsBkB,QAAtB,CAAH,EAAoC;AACnCoC,iCAA2B5P,IAA3B,CAAgCwN,QAAhC;AACA0C,qBAAeH,aAAf,EAA8BvC,QAA9B,EAAwCtL,mBAAxC;AACA;AACD;AAED,IAtBD;;AA2BA4E,YAAS6J,gBAAT,GAA4B,UAASnL,OAAT,EAAkB;AAG7C,QAAGA,QAAQoL,SAAX,EAAsB;AACrB,SAAIC,iBAAiBrL,QAAQsL,SAA7B;AACA,UAAI,IAAIpP,KAAK,CAAb,EAAgBA,KAAKmP,eAAepS,MAApC,EAA4CiD,IAA5C,EAAkD;AACjD,UAAIe,IAAIoO,eAAenP,EAAf,CAAR;AACAd,iBAAW6B,CAAX,IAAgB,CAAC7B,WAAW6B,CAAX,IAAc,CAAf,IAAoB,CAApC;AACA;AACD;;AAGD,QAAG+C,QAAQuL,EAAX,EAAe;AACd5O,YAAOqD,QAAQuL,EAAf,IAAqB,CAAC5O,OAAOqD,QAAQuL,EAAf,IAAmB,CAApB,IAAyB,CAA9C;AACA;AAED,IAhBD;;AAsBAjK,YAASyJ,gBAAT,CAA0B9D,QAA1B,GAAqC,YAAW;AAG/C,QAAIuE,kBAAkB9R,OAAOqD,IAAP,CAAY3B,UAAZ,CAAtB;AACA,QAAIqQ,kBAAkB/R,OAAOqD,IAAP,CAAYkB,UAAZ,CAAtB;AACA,QAAIyN,cAAchS,OAAOqD,IAAP,CAAYJ,MAAZ,CAAlB;AACA,QAAIgP,cAAcjS,OAAOqD,IAAP,CAAYoN,MAAZ,CAAlB;;AAEA,QAAInM,UAAU;AAEb4N,uBAAkB,CAFL;;AAKbC,kBAAa5Q,SAASoK,GAAT,CAAapM,MALb;;AAQb6S,qBAAgBxK,SAASc,WAAT,CAAqBS,iBARxB;AASbkJ,wBAAmBzK,SAASc,WAAT,CAAqBO,oBAT3B;AAUbqJ,sBAAiB1K,SAASc,WAAT,CAAqBQ,uBAVzB;;AAabqJ,cAASP,YAAYzS,MAbR;AAcbiT,oBAAexS,OAAOqD,IAAP,CAAYoN,MAAZ,EAAoBlR,MAdtB;AAebkT,wBAAmB9T,OAAOqT,WAAP,EAAoB;AAAA,aAAKvB,OAAOjR,CAAP,CAAL;AAAA,MAApB,EAAoCD,MAf1C;;AAkBbmT,kBAAaZ,gBAAgBvS,MAlBhB;AAmBboT,wBAAmB3S,OAAOqD,IAAP,CAAYkB,UAAZ,EAAwBhF,MAnB9B;AAoBbqT,4BAAuBjU,OAAOmT,eAAP,EAAwB;AAAA,aAAKvN,WAAWhB,CAAX,CAAL;AAAA,MAAxB,EAA4ChE;AApBtD,KAAd;;AAuBA+E,cAAUD,YAAYC,OAAZ,EAAqBtB,mBAArB,EAA0CtB,UAA1C,EAAsDuB,MAAtD,EAA8DC,gBAA9D,EAAgFqB,UAAhF,CAAV;AACAD,cAAUyB,gBAAgBzB,OAAhB,EAAyB5C,UAAzB,EAAqC6C,UAArC,CAAV;;AAEA8D,oBAAgBG,MAAhB,GAAyBlE,OAAzB;AACA,QAAGzF,OAAO4E,aAAV,EAAyBC,QAAQC,GAAR,CAAY0E,gBAAgBG,MAA5B;AACzB,IApCD;AAwCA,GA1II,EAAL;;AAgJA,OAAK,YAAW;;AAEf,OAAGjH,SAASsR,UAAT,KAAwB,UAA3B,EAAuC;AAGtChU,WAAOiU,gBAAP,CAAwB,MAAxB,EAAgCC,OAAhC;AACAC,eAAWD,OAAX,EAAoB,KAApB;AAEA,IAND,MAMO;AAGNA;AAEA;;AAKD,YAASA,OAAT,GAAmB;AAMlB,QAAIE,YAAY,CAACF,QAAQG,aAAzB,CAAwCH,QAAQG,aAAR,GAAwB,IAAxB;AACxC,QAAG,CAACD,SAAJ,EAAe;AAAE;AAA0B;;AAG3C,QAAG1R,SAAS+H,WAAT,CAAqB/J,MAArB,IAA+B,CAAlC,EAAqC;AAAE;AAAS;;AAGhD,QAAGgC,SAAS+H,WAAT,CAAqB/J,MAArB,IAA+B,CAA/B,IAAoCgI,gBAAvC,EAAyD;AACxD,SAAGhG,SAAS+H,WAAT,CAAqB,CAArB,EAAwB5B,IAAxB,CAA6BvG,OAA7B,CAAqC,eAArC,KAAyD,CAAC,CAA7D,EAAgE;AAC/D;AACA;AACD;;AAGD,QAAIgS,YAAYC,YAAYC,GAAZ,EAAhB;;AAGAzL,aAASc,WAAT,CAAqBC,aAArB,CAAmC7H,IAAnC,CAAwC8G,SAASqD,sBAAjD;AACArD,aAASc,WAAT,CAAqBC,aAArB,CAAmC7H,IAAnC,CAAwC8G,SAASyJ,gBAAjD;AACAzJ,aAASc,WAAT,CAAqBE,gBAArB,CAAsC9H,IAAtC,CAA2C8G,SAAS6J,gBAApD;AACA7J,aAASc,WAAT,CAAqBE,gBAArB,CAAsC9H,IAAtC,CAA2CsF,UAAUC,WAArD;;AAGAuB,aAASc,WAAT,CAAqBM,mBAArB;AACApB,aAASc,WAAT,CAAqBK,iBAArB;AACAnB,aAASqD,sBAAT,CAAgCsC,QAAhC;AACA3F,aAASyJ,gBAAT,CAA0B9D,QAA1B;;AAGA3F,aAASc,WAAT,CAAqBI,UAArB,GAAkC,IAAlC;AACAlB,aAASc,WAAT,CAAqBM,mBAArB;;AAGAX,oBAAgBiL,QAAhB,GAA4BF,YAAYC,GAAZ,KAAoBF,SAArB,GAAgC,CAA3D;;AAGA,QAAGtU,OAAO4E,aAAV,EAAyBC,QAAQC,GAAR,CAAY0E,eAAZ;AACzB,QAAGxJ,OAAO0U,iBAAV,EAA6B;AAC5B1U,YAAO0U,iBAAP,CAAyBlL,eAAzB;AACA;AAED;AAGD,GApEI,EAAL;AAsEA,EA1lCiB,CA0lChB,OAAOgD,EAAP,EAAW;AAA2B,QAAMA,EAAN;AAAW;AAAE,CA1lChD,EAAL;;;AAmmCA,KAAK,YAAW;AACZxM,QAAO+I,QAAP,CAAgBc,WAAhB,CAA4BG,YAA5B,CAAyC/H,IAAzC,CAA+C,SAAS0S,YAAT,CAA2ClN,OAA3C,EAAoDhC,OAApD,EAA6D;AACxG,MAAImP,UAAU,CAAC,OAAD,EAAU,QAAV,EAAoB,eAApB,EAAqC,eAArC,EAAsD,eAAtD,EAAuE,eAAvE,CAAd;;AAEA,MAAGnN,QAAQG,QAAR,IAAoB,MAAvB,EAA+B;AAC3B,QAAI,IAAIiN,IAAI,CAAZ,EAAeA,IAAIpN,QAAQQ,UAAR,CAAmBvH,MAAtC,EAA8CmU,GAA9C,EAAmD;AAC/C,QAAGpN,QAAQQ,UAAR,CAAmB4M,CAAnB,EAAsBjJ,IAAtB,IAA8B,SAAjC,EAA4C;;AAExC,UAAI,IAAIkJ,SAAS,CAAjB,EAAoBA,SAASF,QAAQlU,MAArC,EAA6CoU,QAA7C,EAAuD;AACnD,UAAIxU,QAAQmH,QAAQQ,UAAR,CAAmB4M,CAAnB,EAAsBvU,KAAlC;;AAEA,UAAGA,MAAMgC,OAAN,CAAcsS,QAAQE,MAAR,KAAmB,CAAC,CAAlC,CAAH,EAAyC;AACrCrP,eAAQnF,KAAR,IAAiBmF,QAAQnF,KAAR,KAAkB,EAAE8E,OAAO,CAAT,EAAnC;AACAK,eAAQnF,KAAR,EAAe8E,KAAf;AACA;AACH;AACJ;AACJ;AACJ;AACJ;;AAED,SAAOK,OAAP;AACH,EArBD;AAsBH,CAvBI,EAAL;;;AAkCA,KAAK,YAAW;AACZzF,QAAO+I,QAAP,CAAgBc,WAAhB,CAA4BG,YAA5B,CAAyC/H,IAAzC,CAA+C,SAAS8S,WAAT,CAA0CtN,OAA1C,EAAmDhC,OAAnD,EAA4D;AAGvG,MAAG,CAACgC,QAAQsB,QAAT,IAAqB,EAAEtB,QAAQsB,QAAR,CAAiB,gBAAjB,KAAsCtB,QAAQsB,QAAR,CAAiB,aAAjB,CAAxC,CAAxB,EAAkG;;AAElG,MAAI1D,SAAS,EAAb;;AAGA,MAAGoC,QAAQsB,QAAR,CAAiB,aAAjB,CAAH,EAAoC;AAChC1D,YAASA,OAAOwK,MAAP,CAAcpI,QAAQsB,QAAR,CAAiB,aAAjB,EAAgC+H,WAA9C,CAAT;AACH;;AAED,MAAGrJ,QAAQsB,QAAR,CAAiB,gBAAjB,CAAH,EAAuC;AACnC1D,YAASA,OAAOwK,MAAP,CAAcpI,QAAQsB,QAAR,CAAiB,gBAAjB,EAAmC+H,WAAjD,CAAT;AACH;;AAED,OAAI,IAAInQ,IAAI,CAAZ,EAAeA,IAAI0E,OAAO3E,MAA1B,EAAkCC,GAAlC,EAAuC;AACnC,OAAG0E,OAAO1E,CAAP,EAAU2B,OAAV,CAAkB,GAAlB,CAAH,EAA2B;AACvB,QAAIhC,QAAQ+E,OAAO1E,CAAP,EAAUyI,OAAV,CAAkB,GAAlB,EAAuB,EAAvB,CAAZ;AACA9I,YAAQ0U,WAAW1U,KAAX,CAAR;;AAEA,QAAGA,QAAQ,EAAX,EAAe;AACXmF,aAAQnF,KAAR,IAAiBmF,QAAQnF,KAAR,KAAkB,EAAE8E,OAAO,CAAT,EAAnC;AACAK,aAAQnF,KAAR,EAAe8E,KAAf;AACH;AACJ;AACJ;;AAED,SAAOK,OAAP;AACH,EA7BD;AA8BH,CA/BI,EAAL","file":"cssUsage.min.js","sourcesContent":["void function() {\r\n\r\n\tvar _ = (a => new ArrayWrapper(a));\r\n\t_.mapInline = mapInline;\r\n\t_.map = map; /*.......*/ map.bind = (()=>map);\r\n\t_.filter = filter; /*.*/ filter.bind = (()=>filter);\r\n\t_.reduce = reduce; /*.*/ reduce.bind = (()=>reduce);\r\n\twindow.CSSUsageLodash = _;\r\n\t// test case: \r\n\t// 35 = CSSUsageLodash([1,2,3,4,5]).map(v => v*v).filter(v => v%2).reduce(0, (a,b)=>(a+b)).value()\r\n\t\r\n\tfunction ArrayWrapper(array) {\r\n\t\tthis.source = array;\r\n\t\tthis.mapInline = function(f) { mapInline(this.source, f); return this; };\r\n\t\tthis.map = function(f) { this.source = map(this.source, f); return this; };\r\n\t\tthis.filter = function(f) { this.source = filter(this.source, f); return this; };\r\n\t\tthis.reduce = function(v,f) { this.source = reduce(this.source, f, v); return this; };\r\n\t\tthis.value = function() { return this.source };\r\n\t}\r\n\t\r\n\tfunction map(source, transform) {\r\n\t\tvar clone = new Array(source.length);\r\n\t\tfor(var i = source.length; i--;) {\r\n\t\t\tclone[i] = transform(source[i]);\r\n\t\t}\r\n\t\treturn clone;\r\n\t}\r\n\t\r\n\tfunction mapInline(source, transform) {\r\n\t\tfor(var i = source.length; i--;) {\r\n\t\t\tsource[i] = transform(source[i]);\r\n\t\t}\r\n\t\treturn source;\r\n\t}\r\n\t\r\n\tfunction filter(source, shouldValueBeIncluded) {\r\n\t\tvar clone = new Array(source.length), i=0;\r\n\t\tfor(var s = 0; s <= source.length; s++) {\r\n\t\t\tvar value = source[s];\r\n\t\t\tif(shouldValueBeIncluded(value)) {\r\n\t\t\t\tclone[i++] = value\r\n\t\t\t}\r\n\t\t}\r\n\t\tclone.length = i;\r\n\t\treturn clone;\r\n\t}\r\n\t\r\n\tfunction reduce(source, computeReduction, reduction) {\r\n\t\tfor(var s = 0; s <= source.length; s++) {\r\n\t\t\tvar value = source[s];\r\n\t\t\treduction = computeReduction(reduction, value);\r\n\t\t}\r\n\t\treturn reduction;\r\n\t}\r\n\t\r\n}();\r\n/*!\r\n * Based on:\r\n * https://github.com/gilmoreorless/css-shorthand-properties\r\n * MIT Licensed: http://gilmoreorless.mit-license.org/\r\n */\r\nvoid function () {\r\n    /**\r\n     * Data collated from multiple W3C specs: http://www.w3.org/Style/CSS/current-work\r\n     */\r\n    var shorthands = this.shorthandProperties = {\r\n\t\t\r\n        // CSS 2.1: http://www.w3.org/TR/CSS2/propidx.html\r\n        'list-style':          ['-type', '-position', '-image'],\r\n        'margin':              ['-top', '-right', '-bottom', '-left'],\r\n        'outline':             ['-width', '-style', '-color'],\r\n        'padding':             ['-top', '-right', '-bottom', '-left'],\r\n\r\n        // CSS Backgrounds and Borders Module Level 3: http://www.w3.org/TR/css3-background/\r\n        'background':          ['-image', '-position', '-size', '-repeat', '-origin', '-clip', '-attachment', '-color'],\r\n\t\t'background-repeat':   ['-x','-y'],\r\n\t\t'background-position': ['-x','-y'],\r\n        'border':              ['-width', '-style', '-color'],\r\n        'border-color':        ['border-top-color', 'border-right-color', 'border-bottom-color', 'border-left-color'],\r\n        'border-style':        ['border-top-style', 'border-right-style', 'border-bottom-style', 'border-left-style'],\r\n        'border-width':        ['border-top-width', 'border-right-width', 'border-bottom-width', 'border-left-width'],\r\n        'border-top':          ['-width', '-style', '-color'],\r\n        'border-right':        ['-width', '-style', '-color'],\r\n        'border-bottom':       ['-width', '-style', '-color'],\r\n        'border-left':         ['-width', '-style', '-color'],\r\n        'border-radius':       ['border-top-left-radius', 'border-top-right-radius', 'border-bottom-right-radius', 'border-bottom-left-radius'],\r\n        'border-image':        ['-source', '-slice', '-width', '-outset', '-repeat'],\r\n\r\n        // CSS Fonts Module Level 3: http://www.w3.org/TR/css3-fonts/\r\n        'font':                ['-style', '-variant', '-weight', '-stretch', '-size', 'line-height', '-family'],\r\n        'font-variant':        ['-ligatures', '-alternates', '-caps', '-numeric', '-east-asian'],\r\n\r\n        // CSS Masking Module Level 1: http://www.w3.org/TR/css-masking/\r\n        'mask':                ['-image', '-mode', '-position', '-size', '-repeat', '-origin', '-clip'],\r\n        'mask-border':         ['-source', '-slice', '-width', '-outset', '-repeat', '-mode'],\r\n\r\n        // CSS Multi-column Layout Module: http://www.w3.org/TR/css3-multicol/\r\n        'columns':             ['column-width', 'column-count'],\r\n        'column-rule':         ['-width', '-style', '-color'],\r\n\r\n        // CSS Speech Module: http://www.w3.org/TR/css3-speech/\r\n        'cue':                 ['-before', '-after'],\r\n        'pause':               ['-before', '-after'],\r\n        'rest':                ['-before', '-after'],\r\n\r\n        // CSS Text Decoration Module Level 3: http://www.w3.org/TR/css-text-decor-3/\r\n        'text-decoration':     ['-line', '-style', '-color'],\r\n        'text-emphasis':       ['-style', '-color'],\r\n\r\n        // CSS Animations (WD): http://www.w3.org/TR/css3-animations\r\n        'animation':           ['-name', '-duration', '-timing-function', '-delay', '-iteration-count', '-direction', '-fill-mode', '-play-state'],\r\n\r\n        // CSS Transitions (WD): http://www.w3.org/TR/css3-transitions/\r\n        'transition':          ['-property', '-duration', '-timing-function', '-delay'],\r\n\r\n        // CSS Flexible Box Layout Module Level 1 (WD): http://www.w3.org/TR/css3-flexbox/\r\n        'flex':                ['-grow', '-shrink', '-basis'],\r\n\t\t\r\n\t\t// CSS Grid: https://drafts.csswg.org/css-grid/#grid-shorthand\r\n\t\t'grid':                ['-template', '-auto-flow', '-auto-rows','-auto-columns'],\r\n\t\t'grid-template':       ['-rows', '-columns', '-areas'],\r\n\t\t\r\n\t\t// Others:\r\n\t\t'overflow':            ['-x','-y','-style'], // https://drafts.csswg.org/css-overflow-3/\r\n\t\t\r\n    };\r\n\t\r\n\tvar expandCache = Object.create(null);\r\n\tvar unexpandCache = Object.create(null);\r\n\r\n    /**\r\n     * Expand a shorthand property into an array of longhand properties which are set by it\r\n     * @param  {string} property CSS property name\r\n     * @return {array}           List of longhand properties, or an empty array if it's not a shorthand\r\n     */\r\n    this.expand = function (property) {\r\n\t\t\r\n\t\tvar result = expandCache[property];\r\n\t\tif(result) { return result; }\r\n\t\t\r\n\t\tvar prefixData = property.match(/^(-[a-zA-Z]+-)?(.*)$/);\r\n\t\tvar prefix = prefixData[1]||'', prefixFreeProperty = prefixData[2]||'';\r\n        if (!shorthands.hasOwnProperty(prefixFreeProperty)) {\r\n            return [];\r\n        }\r\n\t\t\r\n\t\tresult = [];\r\n        shorthands[prefixFreeProperty].forEach((p) => {\r\n            var longhand = p[0] === '-' ? property + p : prefix + p;\r\n            result.push(longhand);\r\n\t\t\tresult.push.apply(result, this.expand(longhand));\r\n        });\r\n\t\t\r\n\t\treturn expandCache[property] = result;\r\n\t\t\r\n    };\r\n\t\r\n\t/**\r\n\t * Expand a longhand property into an array of shorthand which may set the value\r\n     * @param  {string} property CSS property name\r\n     * @return {array}           List of shorthand properties, or the original property if it's not a shorthand\r\n\t */\r\n\tthis.unexpand = function unexpand(property) {\r\n\t\t\r\n\t\tvar result = unexpandCache[property];\r\n\t\tif(result) { return result; }\r\n\t\t\r\n\t\tvar prefixData = property.match(/^(-[a-zA-Z]+-)?(.*)$/);\r\n\t\tvar prefix = prefixData[1]||'', prefixFreeProperty = prefixData[2]||'';\r\n\t\t\r\n\t\tresult = [];\r\n\t\tfor(var sh = 0; sh <= shorthands.length; sh++) {\r\n            var shorthand = shorthands[sh];\r\n\t\t\tif(this.expand(shorthand).indexOf(prefixFreeProperty) >= 0) {\r\n\t\t\t\tresult.push(prefix+shorthand);\r\n\t\t\t\tresult.push.apply(result,this.unexpand(prefix+shorthand));\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn unexpandCache[property] = result;\r\n\t\t\r\n\t}\r\n\t\r\n}.call(window.CSSShorthands={});\r\n\r\n\r\n// http://blueprintcss.org/tests/parts/grid.html\r\nvar hasBluePrintUsage = function() {\r\n    \r\n    if(!document.querySelector(\".container\")) {\r\n        return false;\r\n    }\r\n    \r\n    for(var i = 24+1; --i;) {\r\n        if(document.querySelector(\".container > .span-\"+i)) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n    \r\n}\r\n//\r\n// report how many times the classes in the following arrays have been used in the dom\r\n// (bootstrap stats)\r\n//\r\n\r\nvar detectedBootstrapGridUsages = function(domClasses) {\r\n    var _ = window.CSSUsageLodash;\r\n\tvar reduce = _.reduce.bind(_);\r\n    var trackedClasses = [];\r\n    \r\n    var sizes = ['xs','sm','md','lg'];\r\n    for(var i = sizes.length; i--;) { var size = sizes[i];\r\n        for(var j = 12+1; --j;) {\r\n            trackedClasses.push('col-'+size+'-'+j);\r\n            for(var k = 12+1; --k;) {\r\n                trackedClasses.push('col-'+size+'-'+j+'-offset-'+k);\r\n                trackedClasses.push('col-'+size+'-'+j+'-push-'+k);\r\n                trackedClasses.push('col-'+size+'-'+j+'-pull-'+k);\r\n            }\r\n        }\r\n    }\r\n    \r\n    return reduce(trackedClasses, (a,b) => a+(domClasses[b]|0), 0);\r\n    \r\n};\r\n\r\nvar detectedBootstrapFormUsages = function(domClasses) {\r\n    var _ = window.CSSUsageLodash;\r\n\tvar reduce = _.reduce.bind(_);\r\n    var trackedClasses = [\r\n        'form-group', 'form-group-xs', 'form-group-sm', 'form-group-md', 'form-group-lg',\r\n        'form-control', 'form-horizontal', 'form-inline',\r\n        'btn','btn-primary','btn-secondary','btn-success','btn-warning','btn-danger','btn-error'\r\n    ];\r\n    \r\n    return reduce(trackedClasses, (a,b) => a+(domClasses[b]|0), 0);\r\n    \r\n};\r\n\r\nvar detectedBootstrapAlertUsages = function(domClasses) {\r\n    var _ = window.CSSUsageLodash;\r\n\tvar reduce = _.reduce.bind(_);\r\n    var trackedClasses = [\r\n        'alert','alert-primary','alert-secondary','alert-success','alert-warning','alert-danger','alert-error'\r\n    ];\r\n    \r\n    return reduce(trackedClasses, (a,b) => a+(domClasses[b]|0), 0);\r\n    \r\n};\r\n\r\nvar detectedBootstrapFloatUsages = function(domClasses) {\r\n    var _ = window.CSSUsageLodash;\r\n\tvar reduce = _.reduce.bind(_);\r\n    var trackedClasses = [\r\n        'pull-left','pull-right',\r\n    ];\r\n    \r\n    return reduce(trackedClasses, (a,b) => a+(domClasses[b]|0), 0);\r\n    \r\n};\r\n// https://github.com/Dogfalo/materialize/blob/master/sass/components/_grid.scss\r\nvar hasDogfaloMaterializeUsage = function() {\r\n    \r\n    if(!document.querySelector(\".container > .row > .col\")) {\r\n        return false;\r\n    }\r\n    \r\n    for(var i = 12+1; --i;) {\r\n        var classesToLookUp = ['s','m','l'];\r\n        for(var d = 0; d < classesToLookUp.length; d++) {\r\n            var s = classesToLookUp[d];\r\n            if(document.querySelector(\".container > .row > .col.\"+s+\"\"+i)) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n    \r\n}\r\n// http://www.gumbyframework.com/docs/grid/#!/basic-grid\r\nvar hasGrumbyUsage = function() {\r\n    \r\n    if(!document.querySelector(\".row .columns\")) {\r\n        return false;\r\n    }\r\n    \r\n    var classesToLookUp = [\"one\",\"two\",\"three\",\"four\",\"five\",\"six\",\"seven\",\"eight\",\"nine\",\"ten\",\"eleven\",\"twelve\"];\r\n    for(var cl = 0; cl < classesToLookUp.length; cl++ ) {\r\n        var fraction = classesToLookUp[cl];\r\n        if(document.querySelector(\".row > .columns.\"+fraction)) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n    \r\n}\r\n// https://raw.githubusercontent.com/csswizardry/inuit.css/master/generic/_widths.scss\r\nvar hasInuitUsage = function() {\r\n    \r\n    if(!document.querySelector(\".grid .grid__item\")) {\r\n        return false;\r\n    }\r\n    \r\n    var classesToLookUp = [\"one-whole\",\"one-half\",\"one-third\",\"two-thirds\",\"one-quarter\",\"two-quarters\",\"one-half\",\"three-quarters\",\"one-fifth\",\"two-fifths\",\"three-fifths\",\"four-fifths\",\"one-sixth\",\"two-sixths\",\"one-third\",\"three-sixths\",\"one-half\",\"four-sixths\",\"two-thirds\",\"five-sixths\",\"one-eighth\",\"two-eighths\",\"one-quarter\",\"three-eighths\",\"four-eighths\",\"one-half\",\"five-eighths\",\"six-eighths\",\"three-quarters\",\"seven-eighths\",\"one-tenth\",\"two-tenths\",\"one-fifth\",\"three-tenths\",\"four-tenths\",\"two-fifths\",\"five-tenths\",\"one-half\",\"six-tenths\",\"three-fifths\",\"seven-tenths\",\"eight-tenths\",\"four-fifths\",\"nine-tenths\",\"one-twelfth\",\"two-twelfths\",\"one-sixth\",\"three-twelfths\",\"one-quarter\",\"four-twelfths\",\"one-third\",\"five-twelfths\",\"six-twelfths\",\"one-half\",\"seven-twelfths\",\"eight-twelfths\",\"two-thirds\",\"nine-twelfths\",\"three-quarters\",\"ten-twelfths\",\"five-sixths\",\"eleven-twelfths\"];\r\n\r\n    for(var cu = 0; cu < classesToLookUp.length; cu++ ) {\r\n        var fraction = classesToLookUp[cu];\r\n\r\n        var subClassesToLookUp = [\"\",\"palm-\",\"lap-\",\"portable-\",\"desk-\"];\r\n        for(var sc = 0; sc < subClassesToLookUp.length; sc++) {\r\n            var ns = subClassesToLookUp[sc];\r\n            if(document.querySelector(\".grid > .grid__item.\"+ns+fraction)) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n    \r\n}\r\nvar getLonelyGatesUsage = function (cssLonelyClassGates, domClasses, domIds, cssLonelyIdGates) {\r\n\r\n    var _ = window.CSSUsageLodash;\r\n\r\n    if((cssLonelyClassGates || domClasses || domIds || cssLonelyIdGates) == undefined) return;\r\n    \r\n    // get arrays of the .class gates used ({\"hover\":5} => [\"hover\"]), filter irrelevant entries\r\n    var cssUniqueLonelyClassGatesArray = Object.keys(cssLonelyClassGates);\r\n    var cssUniqueLonelyClassGatesUsedArray = _(cssUniqueLonelyClassGatesArray).filter((c) => domClasses[c]).value();\r\n    var cssUniqueLonelyClassGatesUsedWorthArray = _(cssUniqueLonelyClassGatesUsedArray).filter((c)=>(cssLonelyClassGates[c]>9)).value();\r\n    if(window.debugCSSUsage) console.log(cssLonelyClassGates);\r\n    if(window.debugCSSUsage) console.log(cssUniqueLonelyClassGatesUsedWorthArray);\r\n\r\n    // get arrays of the #id gates used ({\"hover\":5} => [\"hover\"]), filter irrelevant entries\r\n    var cssUniqueLonelyIdGatesArray = Object.keys(cssLonelyIdGates);\r\n    var cssUniqueLonelyIdGatesUsedArray = _(cssUniqueLonelyIdGatesArray).filter((c) => domIds[c]).value();\r\n    var cssUniqueLonelyIdGatesUsedWorthArray = _(cssUniqueLonelyIdGatesUsedArray).filter((c)=>(cssLonelyIdGates[c]>9)).value();\r\n    if(window.debugCSSUsage) console.log(cssLonelyIdGates);\r\n    if(window.debugCSSUsage) console.log(cssUniqueLonelyIdGatesUsedWorthArray);\r\n}\r\n//\r\n// report how many times the classes in the following arrays have been used as css gate\r\n// (modernizer stats)\r\n//\r\n\r\n// https://modernizr.com/docs#features\r\nvar detectedModernizerUsages = function(cssLonelyClassGates) {\r\n\r\n    if((cssLonelyClassGates) == undefined) return;\r\n    \r\n    var ModernizerUsages = {count:0,values:{/*  \"js\":1,  \"no-js\":2  */}};\r\n    var trackedClasses = [\"js\",\"ambientlight\",\"applicationcache\",\"audio\",\"batteryapi\",\"blobconstructor\",\"canvas\",\"canvastext\",\"contenteditable\",\"contextmenu\",\"cookies\",\"cors\",\"cryptography\",\"customprotocolhandler\",\"customevent\",\"dart\",\"dataview\",\"emoji\",\"eventlistener\",\"exiforientation\",\"flash\",\"fullscreen\",\"gamepads\",\"geolocation\",\"hashchange\",\"hiddenscroll\",\"history\",\"htmlimports\",\"ie8compat\",\"indexeddb\",\"indexeddbblob\",\"input\",\"search\",\"inputtypes\",\"intl\",\"json\",\"olreversed\",\"mathml\",\"notification\",\"pagevisibility\",\"performance\",\"pointerevents\",\"pointerlock\",\"postmessage\",\"proximity\",\"queryselector\",\"quotamanagement\",\"requestanimationframe\",\"serviceworker\",\"svg\",\"templatestrings\",\"touchevents\",\"typedarrays\",\"unicoderange\",\"unicode\",\"userdata\",\"vibrate\",\"video\",\"vml\",\"webintents\",\"animation\",\"webgl\",\"websockets\",\"xdomainrequest\",\"adownload\",\"audioloop\",\"audiopreload\",\"webaudio\",\"lowbattery\",\"canvasblending\",\"todataurljpeg,todataurlpng,todataurlwebp\",\"canvaswinding\",\"getrandomvalues\",\"cssall\",\"cssanimations\",\"appearance\",\"backdropfilter\",\"backgroundblendmode\",\"backgroundcliptext\",\"bgpositionshorthand\",\"bgpositionxy\",\"bgrepeatspace,bgrepeatround\",\"backgroundsize\",\"bgsizecover\",\"borderimage\",\"borderradius\",\"boxshadow\",\"boxsizing\",\"csscalc\",\"checked\",\"csschunit\",\"csscolumns\",\"cubicbezierrange\",\"display-runin\",\"displaytable\",\"ellipsis\",\"cssescape\",\"cssexunit\",\"cssfilters\",\"flexbox\",\"flexboxlegacy\",\"flexboxtweener\",\"flexwrap\",\"fontface\",\"generatedcontent\",\"cssgradients\",\"hsla\",\"csshyphens,softhyphens,softhyphensfind\",\"cssinvalid\",\"lastchild\",\"cssmask\",\"mediaqueries\",\"multiplebgs\",\"nthchild\",\"objectfit\",\"opacity\",\"overflowscrolling\",\"csspointerevents\",\"csspositionsticky\",\"csspseudoanimations\",\"csspseudotransitions\",\"cssreflections\",\"regions\",\"cssremunit\",\"cssresize\",\"rgba\",\"cssscrollbar\",\"shapes\",\"siblinggeneral\",\"subpixelfont\",\"supports\",\"target\",\"textalignlast\",\"textshadow\",\"csstransforms\",\"csstransforms3d\",\"preserve3d\",\"csstransitions\",\"userselect\",\"cssvalid\",\"cssvhunit\",\"cssvmaxunit\",\"cssvminunit\",\"cssvwunit\",\"willchange\",\"wrapflow\",\"classlist\",\"createelementattrs,createelement-attrs\",\"dataset\",\"documentfragment\",\"hidden\",\"microdata\",\"mutationobserver\",\"bdi\",\"datalistelem\",\"details\",\"outputelem\",\"picture\",\"progressbar,meter\",\"ruby\",\"template\",\"time\",\"texttrackapi,track\",\"unknownelements\",\"es5array\",\"es5date\",\"es5function\",\"es5object\",\"es5\",\"strictmode\",\"es5string\",\"es5syntax\",\"es5undefined\",\"es6array\",\"contains\",\"generators\",\"es6math\",\"es6number\",\"es6object\",\"promises\",\"es6string\",\"devicemotion,deviceorientation\",\"oninput\",\"filereader\",\"filesystem\",\"capture\",\"fileinput\",\"directory\",\"formattribute\",\"localizednumber\",\"placeholder\",\"requestautocomplete\",\"formvalidation\",\"sandbox\",\"seamless\",\"srcdoc\",\"apng\",\"jpeg2000\",\"jpegxr\",\"sizes\",\"srcset\",\"webpalpha\",\"webpanimation\",\"webplossless,webp-lossless\",\"webp\",\"inputformaction\",\"inputformenctype\",\"inputformmethod\",\"inputformtarget\",\"beacon\",\"lowbandwidth\",\"eventsource\",\"fetch\",\"xhrresponsetypearraybuffer\",\"xhrresponsetypeblob\",\"xhrresponsetypedocument\",\"xhrresponsetypejson\",\"xhrresponsetypetext\",\"xhrresponsetype\",\"xhr2\",\"scriptasync\",\"scriptdefer\",\"speechrecognition\",\"speechsynthesis\",\"localstorage\",\"sessionstorage\",\"websqldatabase\",\"stylescoped\",\"svgasimg\",\"svgclippaths\",\"svgfilters\",\"svgforeignobject\",\"inlinesvg\",\"smil\",\"textareamaxlength\",\"bloburls\",\"datauri\",\"urlparser\",\"videoautoplay\",\"videoloop\",\"videopreload\",\"webglextensions\",\"datachannel\",\"getusermedia\",\"peerconnection\",\"websocketsbinary\",\"atob-btoa\",\"framed\",\"matchmedia\",\"blobworkers\",\"dataworkers\",\"sharedworkers\",\"transferables\",\"webworkers\"];\r\n    for(var tc = 0; tc < trackedClasses.length; tc++) {\r\n        var c = trackedClasses[tc];\r\n        countInstancesOfTheClass(c); \r\n        countInstancesOfTheClass('no-'+c);\r\n    }\r\n    return ModernizerUsages;\r\n    \r\n    function countInstancesOfTheClass(c) {\r\n        var count = cssLonelyClassGates[c]; if(!count) return; \r\n        ModernizerUsages.count += count; \r\n        ModernizerUsages.values[c]=count; \r\n    }\r\n    \r\n}\r\nfunction getFwkUsage(results, cssLonelyClassGates, domClasses, domIds, cssLonelyIdGates, cssClasses) {\r\n\r\n    // Modernizer\r\n    getLonelyGatesUsage(cssLonelyClassGates, domClasses, domIds, cssLonelyIdGates);\r\n    detectedModernizerUsages(cssLonelyClassGates);\r\n    results.FwkModernizer = !!window.Modernizer;\r\n    results.FwkModernizerDOMUsages = detectedModernizerUsages(domClasses);\r\n\tresults.FwkModernizerCSSUsages = detectedModernizerUsages(cssLonelyClassGates);\r\n\r\n    // Bootstrap\r\n    results.FwkBootstrap = !!((window.jQuery||window.$) && (window.jQuery||window.$).fn && (window.jQuery||window.$).fn.modal)|0;\r\n    results.FwkBootstrapGridUsage = detectedBootstrapGridUsages(domClasses);\r\n    results.FwkBootstrapFormUsage = detectedBootstrapFormUsages(domClasses);\r\n    results.FwkBootstrapFloatUsage = detectedBootstrapFloatUsages(domClasses);\r\n    results.FwkBootstrapAlertUsage = detectedBootstrapAlertUsages(domClasses);    \r\n    results.FwkBootstrapGridRecognized = detectedBootstrapGridUsages(cssClasses);\r\n    results.FwkBootstrapFormRecognized = detectedBootstrapFormUsages(cssClasses);\r\n    results.FwkBootstrapFloatRecognized = detectedBootstrapFloatUsages(cssClasses);\r\n    results.FwkBootstrapAlertRecognized = detectedBootstrapAlertUsages(cssClasses);\r\n\r\n    // Grumby\r\n    results.FwkGrumby = hasGrumbyUsage()|0;\r\n\r\n    // Inuit\r\n    results.FwkInuit = hasInuitUsage()|0;\r\n\r\n    // Blueprint\r\n    results.FwkBluePrint = hasBluePrintUsage()|0;\r\n\r\n    // Dog Falo\r\n    results.FwkDogfaloMaterialize = hasDogfaloMaterializeUsage()|0;\r\n\r\n    return results;\r\n}\r\n//\r\n// report how many times the classes in the following arrays have been used in the dom\r\n// (general stats)\r\n//\r\n\r\n/** count how many times the usual clearfix classes are used */\r\nvar detectedClearfixUsages = function(domClasses) {\r\n\r\n    var _ = window.CSSUsageLodash;\r\n\tvar reduce = _.reduce.bind(_);\r\n    \r\n    var trackedClasses = [\r\n        'clearfix','clear',\r\n    ];\r\n    \r\n    return reduce(trackedClasses, (a,b) => a+(domClasses[b]|0), 0);\r\n    \r\n};\r\n\r\n/** count how many times the usual hide/show classes are used */\r\nvar detectedVisibilityUsages = function(domClasses) {\r\n    var _ = window.CSSUsageLodash;\r\n\tvar reduce = _.reduce.bind(_);\r\n    \r\n    var trackedClasses = [\r\n        'show', 'hide', 'visible', 'hidden', \r\n    ];\r\n    \r\n    return reduce(trackedClasses, (a,b) => a+(domClasses[b]|0), 0);\r\n    \r\n};\r\nfunction getPatternUsage(results, domClasses, cssClasses) {\r\n    results.PatClearfixUsage = detectedClearfixUsages(domClasses);\r\n\tresults.PatVisibilityUsage = detectedVisibilityUsages(domClasses);\r\n    results.PatClearfixRecognized = detectedClearfixUsages(cssClasses);\r\n    results.PatVisibilityRecognized = detectedVisibilityUsages(cssClasses);\r\n\r\n    return results;\r\n}\r\nvoid function() {\n\n    window.HtmlUsage = {};\n\n    // This function has been added to the elementAnalyzers in\n    // CSSUsage.js under onready()\n    // <param name=\"element\"> is an HTMLElement passed in by elementAnalyzers\n    window.HtmlUsage.GetNodeName = function (element) {\n\n        // If the browser doesn't recognize the element - throw it away\n        if(element instanceof HTMLUnknownElement) {\n            return;\n        }\n\n        var node = element.nodeName;\n\n        var tags = HtmlUsageResults.tags || (HtmlUsageResults.tags = {});\n        var tag = tags[node] || (tags[node] = 0);\n        tags[node]++;\n\n        GetAttributes(element, node);\n    }\n\n    function GetAttributes(element, node) {\n        for(var i = 0; i < element.attributes.length; i++) {\n            var att = element.attributes[i];\n\n            if(IsValidAttribute(element, att.nodeName)) {\n                var attributes = HtmlUsageResults.attributes || (HtmlUsageResults.attributes = {});\n                var attribute = attributes[att.nodeName] || (attributes[att.nodeName] = {});\n                var attributeTag = attribute[node] || (attribute[node] = {count: 0});             \n                attributeTag.count++;\n            }\n        }\n    }\n\n    function IsValidAttribute(element, attname) {\n        // We need to convert className\n        if(attname == \"class\") {\n            attname = \"className\";\n        } \n\n        if(attname == \"classname\") {\n            return false;\n        }\n\n        // Only keep attributes that are not data\n        if(attname.indexOf('data-') != -1) {\n            return false;\n        }\n\n        /*if(typeof(element[attname]) == \"undefined\") {\n            return false;\n        }*/\n\n        return true;\n    }\n}();\r\nvoid function() { try {\r\n\t\r\n\tvar _ = window.CSSUsageLodash;\r\n\tvar map = _.map.bind(_);\r\n\tvar mapInline = _.mapInline ? _.mapInline : map;\r\n\tvar reduce = _.reduce.bind(_);\r\n\tvar filter = _.filter.bind(_);\r\n\t\r\n\tvar browserIsEdge = navigator.userAgent.indexOf('Edge')>=0;\r\n\tvar browserIsFirefox = navigator.userAgent.indexOf('Firefox')>=0;\r\n\t\r\n\t//\r\n\t// Guards execution against invalid conditions\r\n\t//\r\n\tvoid function() {\r\n\t\t\r\n\t\t// Don't run in subframes for now\r\n\t\tif (top.location.href !== location.href) throw new Error(\"CSSUsage: the script doesn't run in frames for now\");\r\n\t\t\r\n\t\t// Don't run if already ran\r\n\t\tif (window.CSSUsage) throw new Error(\"CSSUsage: second execution attempted; only one run can be executed; if you specified parameters, check the right ones were chosen\");\r\n\t\t\r\n\t\t// Don't run if we don't have lodash\r\n\t\tif (!window.CSSUsageLodash) throw new Error(\"CSSUsage: missing CSSUsageLodash dependency\");\r\n\r\n\t\tif (!window.HtmlUsage) throw new Error(\"APIUsage: missing HtmlUsage dependancy\");\r\n\t\t\r\n\t\t// Do not allow buggy trim() to bother usage\r\n\t\tif((''+String.prototype.trim).indexOf(\"[native code]\") == -1) {\r\n\t\t\tconsole.warn('Replaced custom trim function with something known to work. Might break website.');\r\n\t\t\tString.prototype.trim = function() {\r\n\t\t\t\treturn this.replace(/^\\s+|\\s+$/g, '');\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t}();\r\n\r\n\t//\r\n\t// Prepare our global namespace\r\n\t//\r\n\tvoid function() {\t\t\r\n\t\twindow.HtmlUsageResults = {\r\n\t\t\t// this will contain all of the HTML tags used on a page\r\n\t\t\ttags: {}, /*\r\n\t\t\ttags ~= [nodeName] */\r\n\r\n\t\t\t// this will contain all of the attributes used on an HTML tag\r\n\t\t\t// and their values if they are in the whitelist\r\n\t\t\tattributes: {} /*\r\n\t\t\tattributes ~= {\r\n\t\t\t\tname: <string>, // The name of the attribute \r\n\t\t\t\ttag: <string>,  // The tag that the attr was used on\r\n\t\t\t\tvalue: <string> // The value of the attr\r\n\t\t\t} */\r\n\t\t};\r\n\r\n\t\twindow.RecipeResults = {};\r\n\t\twindow.Recipes = {\r\n\t\t\trecipes: []\r\n\t\t};\r\n\r\n\t\twindow.CSSUsage = {};\r\n\t\twindow.CSSUsageResults = {\r\n\t\t\t\r\n\t\t\t// this will contain the usage stats of various at-rules and rules\r\n\t\t\ttypes: [ 0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0, ], /* \r\n\t\t\ttypes ~= {\r\n\t\t\t\t\"unknown\":0,   //0\r\n\t\t\t\t\"style\":0,     //1\r\n\t\t\t\t\"charset\": 0,  //2\r\n\t\t\t\t\"import\":0,    //3\r\n\t\t\t\t\"media\":0,     //4\r\n\t\t\t\t\"font-face\":0, //5\r\n\t\t\t\t\"page\":0,      //6\r\n\t\t\t\t\"keyframes\":0, //7 This is the @keyframe at rule\r\n\t\t\t\t\"keyframe\":0,  //8 This is the individual 0%, or from/to\r\n\t\t\t\t\"reserved9\":0, //9\r\n\t\t\t\t\"namespace\":0, //10\r\n\t\t\t\t\"reserved11\":0,//11\r\n\t\t\t\t\"supports\":0,  //12\r\n\t\t\t\t\"reserved13\":0,//13\r\n\t\t\t\t\"reserved14\":0,//14\r\n\t\t\t\t\"viewport\":0,  //15\r\n\t\t\t}*/\r\n\t\t\t\r\n\t\t\t// this will contain the usage stats of various css properties and values\r\n\t\t\tprops: Object.create(null), /*\r\n\t\t\tprops ~= {\r\n\t\t\t\t\"background-color\": {\r\n\t\t\t\t\tcount: 10,\r\n\t\t\t\t\tvalues: {\r\n\t\t\t\t\t\t\"<color-keyword>\": 9,\r\n\t\t\t\t\t\t\"inherit\": 1\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}*/\r\n\t\t\t\r\n\t\t\t// this will contains the various datapoints we measure on css selector usage\r\n\t\t\tusages: {\"SuccessfulCrawls\":1},\r\n\t\t\t\r\n\t\t\t// this will contain selectors and the properties they refer to\r\n\t\t\trules: {\"@stylerule\":0,\"@atrule\":0,\"@inline\":0}, /*\r\n\t\t\trules ~= {\r\n\t\t\t\t\"#id:hover .class\": {\r\n\t\t\t\t\tcount: 10,\r\n\t\t\t\t\tprops: {\r\n\t\t\t\t\t\t\"background-color\": 5,\r\n\t\t\t\t\t\t\"color\": 4,\r\n\t\t\t\t\t\t\"opacity\": 3,\r\n\t\t\t\t\t\t\"transform\": 3\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}*/\r\n\t\t\t\r\n\t\t}\r\n\t}();\r\n\r\n\t//\r\n\t// The StyleWalker API cover the extraction of style in the browser\r\n\t//\r\n\tvoid function() { \"use strict\";\r\n\r\n\t\tCSSUsage.StyleWalker = {\r\n\t\t\t\r\n\t\t\t// This array contains the list of functions being run on each CSSStyleDeclaration\r\n\t\t\t// [ function(style, selectorText, matchedElements, ruleType) { ... }, ... ]\r\n\t\t\truleAnalyzers: [],\r\n\t\t\t\r\n\t\t\t// This array contains the list of functions being run on each DOM element of the page\r\n\t\t\t// [ function(element) { ...} ]\r\n\t\t\telementAnalyzers: [],\r\n\r\n\t\t\trecipesToRun: [],\r\n\t\t\trunRecipes: false,\r\n\r\n\t\t\t// \r\n\t\t\twalkOverCssStyles: walkOverCssStyles,\r\n\t\t\twalkOverDomElements: walkOverDomElements,\r\n\t\t\t\r\n\t\t\t// Those stats are being collected while walking over the css style rules\r\n\t\t\tamountOfInlineStyles: 0,\r\n\t\t\tamountOfSelectorsUnused: 0,\r\n\t\t\tamountOfSelectors: 0,\r\n\t\t}\r\n\t\t\r\n\t\tvar hasWalkedDomElementsOnce = false;\r\n\t\t// holds @keyframes temporarily while we wait to know how much they are used\r\n\t\tvar keyframes = Object.create(null);\r\n\t\t\r\n\t\t/**\r\n\t\t * For all stylesheets of the document, \r\n\t\t * walk through the stylerules and run analyzers\r\n\t\t */\r\n\t\tfunction walkOverCssStyles() {\r\n\t\t\tvar styleSheets = document.styleSheets;\r\n\r\n\t\t\t// Loop through StyeSheets\r\n\t\t\tfor (var ssIndex = styleSheets.length; ssIndex--;) {\r\n\t\t\t\tvar styleSheet = styleSheets[ssIndex];\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif(styleSheet.cssRules) {\r\n\t\t\t\t\t\twalkOverCssRules(styleSheet.cssRules, styleSheet);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.warn(\"No content loaded for stylesheet: \", styleSheet.href||styleSheet);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcatch (e) {\r\n\t\t\t\t\tconsole.log(e, e.stack);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Hack: rely on the results to find out which\r\n\t\t\t// animations actually run, and parse their keyframes\r\n\t\t\tvar animations = (CSSUsageResults.props['animation-name']||{}).values||{};\r\n\t\t\tfor(var animation in keyframes) {\r\n\t\t\t\tvar keyframe = keyframes[animation];\r\n\t\t\t\tvar matchCount = animations[animation]|0;\r\n\t\t\t\tvar fakeElements = initArray(matchCount, (i)=>({tagName:'@keyframes '+animation+' ['+i+']'}));\r\n\t\t\t\tprocessRule(keyframe, fakeElements);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * This is the css work horse, this will will loop over the\r\n\t\t * rules and then call the rule analyzers currently registered\r\n\t\t */\r\n\t\tfunction walkOverCssRules(/*CSSRuleList*/ cssRules, styleSheet, parentMatchedElements) {\r\n\t\t\tfor (var ruleIndex = cssRules.length; ruleIndex--;) {\r\n\r\n\t\t\t\t// Loop through the rules\r\n\t\t\t\tvar rule = cssRules[ruleIndex];\r\n\r\n\t\t\t\t// Until we can correlate animation usage\r\n\t\t\t\t// to keyframes do not parse @keyframe rules\r\n\t\t\t\tif(rule.type == 7) {\r\n\t\t\t\t\tkeyframes[rule.name] = rule;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// Filter \"@supports\" which the current browser doesn't support\r\n\t\t\t\tif(rule.type == 12 && (!CSS.supports || !CSS.supports(rule.conditionText))) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t// Other rules should be processed immediately\r\n\t\t\t\tprocessRule(rule,parentMatchedElements);\r\n\t\t\t\t\t\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t/**\r\n\t\t * This function takes a css rule and:\r\n\t\t * [1] walk over its child rules if needed\r\n\t\t * [2] call rule analyzers for that rule if it has style data\r\n\t\t */\r\n\t\tfunction processRule(rule, parentMatchedElements) {\r\n\t\t\t\r\n\t\t\t// Increment the rule type's counter\r\n\t\t\tCSSUsageResults.types[rule.type|0]++; \r\n\r\n\t\t\t// Some CssRules have nested rules to walk through:\r\n\t\t\tif (rule.cssRules && rule.cssRules.length>0) {\r\n\t\t\t\t\r\n\t\t\t\twalkOverCssRules(rule.cssRules, rule.parentStyleSheet, parentMatchedElements);\r\n\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t\t// Some CssRules have style we can ananlyze\r\n\t\t\tif(rule.style) {\r\n\t\t\t\t\r\n\t\t\t\t// find what the rule applies to\r\n\t\t\t\tvar selectorText;\r\n\t\t\t\tvar matchedElements; \r\n\t\t\t\tif(rule.selectorText) {\r\n\t\t\t\t\tselectorText = CSSUsage.PropertyValuesAnalyzer.cleanSelectorText(rule.selectorText);\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tif(parentMatchedElements) {\r\n\t\t\t\t\t\t\tmatchedElements = [].slice.call(document.querySelectorAll(selectorText));\r\n\t\t\t\t\t\t\tmatchedElements.parentMatchedElements = parentMatchedElements;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tmatchedElements = [].slice.call(document.querySelectorAll(selectorText));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch(ex) {\r\n\t\t\t\t\t\tmatchedElements = [];\r\n\t\t\t\t\t\tconsole.warn(ex.stack||(\"Invalid selector: \"+selectorText+\" -- via \"+rule.selectorText));\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tselectorText = '@atrule:'+rule.type;\r\n\t\t\t\t\tif(parentMatchedElements) {\r\n\t\t\t\t\t\tmatchedElements = parentMatchedElements;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmatchedElements = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// run an analysis on it\r\n\t\t\t\trunRuleAnalyzers(rule.style, selectorText, matchedElements, rule.type);\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * This is the dom work horse, this will will loop over the\r\n\t\t * dom elements and then call the element analyzers currently registered,\r\n\t\t * as well as rule analyzers for inline styles\r\n\t\t */\r\n\t\tfunction walkOverDomElements(obj, index) {\r\n\t\t\tvar recipesToRun = CSSUsage.StyleWalker.recipesToRun;\t\t\t\r\n\t\t\tobj = obj || document.documentElement; index = index|0;\r\n\r\n\t\t\t// Loop through the elements\r\n\t\t\tvar elements = [].slice.call(document.all,0);\r\n\t\t\tfor(var i = 0; i < elements.length; i++) { \r\n\t\t\t\tvar element=elements[i];\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t// Analyze its style, if any\r\n\t\t\t\tif(!CSSUsage.StyleWalker.runRecipes) {\r\n\t\t\t\t\t// Analyze the element\r\n\t\t\t\t\trunElementAnalyzers(element, index);\r\n\r\n\t\t\t\t\tif (element.hasAttribute('style')) {\t\t\t\t\t\r\n\t\t\t\t\t\t// Inline styles count like a style rule with no selector but one matched element\r\n\t\t\t\t\t\tvar ruleType = 1;\r\n\t\t\t\t\t\tvar isInline = true;\r\n\t\t\t\t\t\tvar selectorText = '@inline:'+element.tagName;\r\n\t\t\t\t\t\tvar matchedElements = [element];\r\n\t\t\t\t\t\trunRuleAnalyzers(element.style, selectorText, matchedElements, ruleType, isInline);\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t} else { // We've already walked the DOM crawler and need to run the recipes\r\n\t\t\t\t\tfor(var r = 0; r < recipesToRun.length ; r++) {\r\n\t\t\t\t\t\tvar recipeToRun = recipesToRun[r];\r\n\t\t\t\t\t\tvar results = RecipeResults[recipeToRun.name] || (RecipeResults[recipeToRun.name]={});\r\n\t\t\t\t\t\trecipeToRun(element, results, true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Given a rule and its data, send it to all rule analyzers\r\n\t\t */\r\n\t\tfunction runRuleAnalyzers(style, selectorText, matchedElements, type, isInline) {\r\n\t\t\t\r\n\t\t\t// Keep track of the counters\r\n\t\t\tif(isInline) {\r\n\t\t\t\tCSSUsage.StyleWalker.amountOfInlineStyles++;\r\n\t\t\t} else {\r\n\t\t\t\tCSSUsage.StyleWalker.amountOfSelectors++;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Run all rule analyzers\r\n\t\t\tfor(var i = 0; i < CSSUsage.StyleWalker.ruleAnalyzers.length; i++) {\r\n\t\t\t\tvar runAnalyzer = CSSUsage.StyleWalker.ruleAnalyzers[i];\r\n\t\t\t\trunAnalyzer(style, selectorText, matchedElements, type, isInline);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t/**\r\n\t\t * Given an element and its data, send it to all element analyzers\r\n\t\t */\r\n\t\tfunction runElementAnalyzers(element, index, depth) {\r\n\t\t\tfor(var i = 0; i < CSSUsage.StyleWalker.elementAnalyzers.length; i++) {\r\n\t\t\t\tvar runAnalyzer = CSSUsage.StyleWalker.elementAnalyzers[i];\r\n\t\t\t\trunAnalyzer(element, index, depth);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t/**\r\n\t\t * Creates an array of \"length\" elements, by calling initializer for each cell\r\n\t\t */\r\n\t\tfunction initArray(length, initializer) {\r\n\t\t\tvar array = Array(length);\r\n\t\t\tfor(var i = length; i--;) { \r\n\t\t\t\tarray[i] = initializer(i);\r\n\t\t\t}\r\n\t\t\treturn array;\r\n\t\t}\r\n\t}();\r\n\r\n\t//\r\n\t// helper to work with css values\r\n\t//\r\n\tvoid function() {\r\n\r\n\t\tCSSUsage.CSSValues = {\r\n\t\t\tcreateValueArray: createValueArray,\r\n\t\t\tparseValues: parseValues,\r\n\t\t\tnormalizeValue: createValueArray\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * This will take a string value and reduce it down\r\n\t\t * to only the aspects of the value we wish to keep\r\n\t\t */\r\n\t\tfunction parseValues(value,propertyName) {\r\n\t\t\t\r\n\t\t\t// Trim value on the edges\r\n\t\t\tvalue = value.trim();\r\n\t\t\t\r\n\t\t\t// Normalize letter-casing\r\n\t\t\tvalue = value.toLowerCase();\r\n\r\n\t\t\t// Map colors to a standard value (eg: white, blue, yellow)\r\n\t\t\tif (isKeywordColor(value)) { return \"<color-keyword>\"; }\r\n\t\t\tvalue = value.replace(/[#][0-9a-fA-F]+/g, '#xxyyzz');\r\n\t\t\t\r\n\t\t\t// Escapce identifiers containing numbers\r\n\t\t\tvar numbers = ['ZERO','ONE','TWO','THREE','FOUR','FIVE','SIX','SEVEN','EIGHT','NINE'];\r\n\t\t\tvalue = value.replace(\r\n\t\t\t\t/([_a-z][-_a-z]|[_a-df-z])[0-9]+[-_a-z0-9]*/g, \r\n\t\t\t\ts=>numbers.reduce(\r\n\t\t\t\t\t(m,nstr,nint)=>m.replace(RegExp(nint,'g'),nstr),\r\n\t\t\t\t\ts\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\t// Remove any digits eg: 55px -> px, 1.5 -> 0.0, 1 -> 0\r\n\t\t\tvalue = value.replace(/(?:[+]|[-]|)(?:(?:[0-9]+)(?:[.][0-9]+|)|(?:[.][0-9]+))(?:[e](?:[+]|[-]|)(?:[0-9]+))?(%|e[a-z]+|[a-df-z][a-z]*)/g, \"$1\"); \r\n\t\t\tvalue = value.replace(/(?:[+]|[-]|)(?:[0-9]+)(?:[.][0-9]+)(?:[e](?:[+]|[-]|)(?:[0-9]+))?/g, \" <float> \");\r\n\t\t\tvalue = value.replace(/(?:[+]|[-]|)(?:[.][0-9]+)(?:[e](?:[+]|[-]|)(?:[0-9]+))?/g, \" <float> \");\r\n\t\t\tvalue = value.replace(/(?:[+]|[-]|)(?:[0-9]+)(?:[e](?:[+]|[-]|)(?:[0-9]+))/g, \" <float> \");\r\n\t\t\tvalue = value.replace(/(?:[+]|[-]|)(?:[0-9]+)/g, \" <int> \");\r\n\t\t\t\r\n\t\t\t// Unescapce identifiers containing numbers\r\n\t\t\tvalue = numbers.reduce(\r\n\t\t\t\t(m,nstr,nint)=>m.replace(RegExp(nstr,'g'),nint),\r\n\t\t\t\tvalue\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\t// Remove quotes\r\n\t\t\tvalue = value.replace(/('|‘|’|\")/g, \"\");\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tswitch(propertyName) {\r\n\t\t\t\tcase 'counter-increment':\r\n\t\t\t\tcase 'counter-reset':\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Anonymize the user identifier\r\n\t\t\t\t\tvalue = value.replace(/[-_a-zA-Z0-9]+/g,' <custom-ident> ');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\t\r\n\t\t\t\tcase 'grid':\r\n\t\t\t\tcase 'grid-template':\r\n\t\t\t\tcase 'grid-template-rows':\r\n\t\t\t\tcase 'grid-template-columns':\r\n\t\t\t\tcase 'grid-template-areas':\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Anonymize line names\r\n\t\t\t\t\tvalue = value.replace(/\\[[-_a-zA-Z0-9 ]+\\]/g,' <line-names> ');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\t\r\n\t\t\t\tcase '--var':\r\n\t\t\t\t\r\n\t\t\t\t\t// Replace (...), {...} and [...]\r\n\t\t\t\t\tvalue = value.replace(/[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]*)[)])*[)])*[)])*[)])*[)]/g, \" <parentheses-block> \");\r\n\t\t\t\t\tvalue = value.replace(/[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]*)[)])*[)])*[)])*[)])*[)]/g, \" <parentheses-block> \");\r\n\t\t\t\t\tvalue = value.replace(/\\[(?:[^()]+|\\[(?:[^()]+|\\[(?:[^()]+|\\[(?:[^()]+|\\[(?:[^()]*)\\])*\\])*\\])*\\])*\\]/g, \" <curly-brackets-block> \");\r\n\t\t\t\t\tvalue = value.replace(/\\[(?:[^()]+|\\[(?:[^()]+|\\[(?:[^()]+|\\[(?:[^()]+|\\[(?:[^()]*)\\])*\\])*\\])*\\])*\\]/g, \" <curly-brackets-block> \");\r\n\t\t\t\t\tvalue = value.replace(/\\{(?:[^()]+|\\{(?:[^()]+|\\{(?:[^()]+|\\{(?:[^()]+|\\{(?:[^()]*)\\})*\\})*\\})*\\})*\\}/g, \" <square-brackets-block> \");\r\n\t\t\t\t\tvalue = value.replace(/\\{(?:[^()]+|\\{(?:[^()]+|\\{(?:[^()]+|\\{(?:[^()]+|\\{(?:[^()]*)\\})*\\})*\\})*\\})*\\}/g, \" <square-brackets-block> \");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\t\r\n\t\t\t}\r\n\t\t\t \r\n\t\t\treturn value.trim();\r\n\t\t\t \r\n\t\t}\r\n\r\n\t\t//-----------------------------------------------------------------------------\r\n\r\n\t\t/**\r\n\t\t * This will transform a value into an array of value identifiers\r\n\t\t */ \r\n\t\tfunction createValueArray(value, propertyName) {\r\n\r\n\t\t\t// Trim value on the edges\r\n\t\t\tvalue = value.trim();\r\n\t\t\t\r\n\t\t\t// Normalize letter-casing\r\n\t\t\tvalue = value.toLowerCase();\r\n\t\t\t\r\n\t\t\t// Remove comments and !important\r\n\t\t\tvalue = value.replace(/([/][*](?:.|\\r|\\n)*[*][/]|[!]important.*)/g,'');\r\n\t\t\t\r\n\t\t\t// Do the right thing in function of the property\r\n\t\t\tswitch(propertyName) {\r\n\t\t\t\tcase 'font-family':\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Remove various quotes\r\n\t\t\t\t\tif (value.indexOf(\"'\") != -1 || value.indexOf(\"‘\") != -1 || value.indexOf('\"')) {\r\n\t\t\t\t\t\tvalue = value.replace(/('|‘|’|\")/g, \"\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Divide at commas to separate different font names\r\n\t\t\t\t\tvalue = value.split(/\\s*,\\s*/g);\r\n\t\t\t\t\treturn value;\r\n\t\t\t\t\t\r\n\t\t\t\tcase '--var':\r\n\t\t\t\t\r\n\t\t\t\t\t// Replace strings by dummies\r\n\t\t\t\t\tvalue = value.replace(/\"([^\"\\\\]|\\\\[^\"\\\\]|\\\\\\\\|\\\\\")*\"/g,' <string> ')\r\n\t\t\t\t\tvalue = value.replace(/'([^'\\\\]|\\\\[^'\\\\]|\\\\\\\\|\\\\')*'/g,' <string> ');\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Replace url(...) functions by dummies\r\n\t\t\t\t\tvalue = value.replace(/([a-z]?)[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]*)[)])*[)])*[)])*[)])*[)]/g, \"$1()\");\r\n\t\t\t\t\tvalue = value.replace(/([a-z]?)[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]*)[)])*[)])*[)])*[)])*[)]/g, \"$1()\");\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Remove group contents (...), {...} and [...]\r\n\t\t\t\t\tvalue = value.replace(/[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]*)[)])*[)])*[)])*[)])*[)]/g, \" <parentheses-block> \");\r\n\t\t\t\t\tvalue = value.replace(/[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]*)[)])*[)])*[)])*[)])*[)]/g, \" <parentheses-block> \");\r\n\t\t\t\t\tvalue = value.replace(/[{](?:[^{}]+|[{](?:[^{}]+|[{](?:[^{}]+|[{](?:[^{}]+|[{](?:[^{}]*)[}])*[}])*[}])*[}])*[}]/g, \" <curly-brackets-block> \");\r\n\t\t\t\t\tvalue = value.replace(/[{](?:[^{}]+|[{](?:[^{}]+|[{](?:[^{}]+|[{](?:[^{}]+|[{](?:[^{}]*)[}])*[}])*[}])*[}])*[}]/g, \" <curly-brackets-block> \");\r\n\t\t\t\t\tvalue = value.replace(/[\\[](?:[^\\[\\]]+|[\\[](?:[^\\[\\]]+|[\\[](?:[^\\[\\]]+|[\\[](?:[^\\[\\]]+|[\\[](?:[^\\[\\]]*)[\\]])*[\\]])*[\\]])*[\\]])*[\\]]/g, \" <square-brackets-block> \");\r\n\t\t\t\t\tvalue = value.replace(/[\\[](?:[^\\[\\]]+|[\\[](?:[^\\[\\]]+|[\\[](?:[^\\[\\]]+|[\\[](?:[^\\[\\]]+|[\\[](?:[^\\[\\]]*)[\\]])*[\\]])*[\\]])*[\\]])*[\\]]/g, \" <square-brackets-block> \");\r\n\t\t\t\t\t\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\t\r\n\t\t\t\tdefault:\r\n\t\t\t\t\r\n\t\t\t\t\t// Replace strings by dummies\r\n\t\t\t\t\tvalue = value.replace(/\"([^\"\\\\]|\\\\[^\"\\\\]|\\\\\\\\|\\\\\")*\"/g,' <string> ')\r\n\t\t\t\t\t\t\t\t .replace(/'([^'\\\\]|\\\\[^'\\\\]|\\\\\\\\|\\\\')*'/g,' <string> ');\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Replace url(...) functions by dummies\r\n\t\t\t\t\tif (value.indexOf(\"(\") != -1) {\r\n\t\t\t\t\t\tvalue = value.replace(/([a-z]?)[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]*)[)])*[)])*[)])*[)])*[)]/g, \"$1() \");\r\n\t\t\t\t\t\tvalue = value.replace(/([a-z]?)[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]*)[)])*[)])*[)])*[)])*[)]/g, \"$1() \");\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Collapse whitespace\r\n\t\t\tvalue = value.trim().replace(/\\s+/g, \" \");\r\n\t\t\t\r\n\t\t\t// Divide at commas and spaces to separate different values\r\n\t\t\tvalue = value.split(/\\s*(?:,|[/])\\s*|\\s+/g);\r\n\t\t\t\r\n\t\t\treturn value;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * So that we don't end up with a ton of color\r\n\t\t * values, this will determine if the color is a\r\n\t\t * keyword color value\r\n\t\t */\r\n\t\tfunction isKeywordColor(candidateColor) {\r\n\t\t\t\r\n\t\t\t// Keyword colors from the W3C specs\r\n\t\t\tvar isColorKeyword = /^(aliceblue|antiquewhite|aqua|aquamarine|azure|beige|bisque|black|blanchedalmond|blue|blueviolet|brown|burlywood|cadetblue|chartreuse|chocolate|coral|cornflowerblue|cornsilk|crimson|cyan|darkblue|darkcyan|darkgoldenrod|darkgray|darkgrey|darkgreen|darkkhaki|darkmagenta|darkolivegreen|darkorange|darkorchid|darkred|darksalmon|darkseagreen|darkslateblue|darkslategray|darkslategrey|darkturquoise|darkviolet|deeppink|deepskyblue|dimgray|dimgrey|dodgerblue|firebrick|floralwhite|forestgreen|fuchsia|gainsboro|ghostwhite|gold|goldenrod|gray|grey|green|greenyellow|honeydew|hotpink|indianred|indigo|ivory|khaki|lavender|lavenderblush|lawngreen|lemonchiffon|lightblue|lightcoral|lightcyan|lightgoldenrodyellow|lightgreen|lightgray|lightgrey|lightpink|lightsalmon|lightseagreen|lightskyblue|lightslategray|lighslategrey|lightsteelblue|lightyellow|lime|limegreen|linen|magenta|maroon|mediumaquamarine|mediumblue|mediumorchid|mediumpurple|mediumseagreen|mediumslateblue|mediumspringgreen|mediumturquoise|mediumvioletred|midnightblue|mintcream|mistyrose|moccasin|navajowhite|navy|navyblue|oldlace|olive|olivedrab|orange|orangered|orchid|palegoldenrod|palegreen|paleturquoise|palevioletred|papayawhip|peachpuff|peru|pink|plum|powderblue|purple|rebeccapurple|red|rosybrown|royalblue|saddlebrown|salmon|sandybrown|seagreen|seashell|sienna|silver|skyblue|slateblue|slategray|slategrey|snow|springgreen|steelblue|tan|teal|thistle|tomato|turquoise|violet|wheat|white|whitesmoke|yellow|yellowgreen)$/;\r\n\t\t\treturn isColorKeyword.test(candidateColor);\r\n\t\t\t\r\n\t\t}\r\n\r\n\t}();\r\n\r\n\t//\r\n\t// computes various css stats\r\n\t//\r\n\tvoid function() {\r\n\r\n\t\tCSSUsage.PropertyValuesAnalyzer = analyzeStyleOfRule;\r\n\t\tCSSUsage.PropertyValuesAnalyzer.cleanSelectorText = cleanSelectorText;\r\n\t\tCSSUsage.PropertyValuesAnalyzer.generalizedSelectorsOf = generalizedSelectorsOf;\r\n\t\tCSSUsage.PropertyValuesAnalyzer.finalize = finalize;\r\n\r\n\t\t// We put a computed style in cache for filtering purposes\r\n\t\tvar defaultStyle = getComputedStyle(document.createElement('div'));\r\n\t\t// As well as some basic lies\r\n\t\tvar getBuggyValuesForThisBrowser = function() {\r\n\t\t\tvar buggyValues = getBuggyValuesForThisBrowser.cache;\r\n\t\t\tif(buggyValues) { return buggyValues; }\r\n\t\t\telse { buggyValues = Object.create(null); }\r\n\t\t\t\r\n\t\t\t// Edge reports initial value instead of \"initial\", we have to be cautious\r\n\t\t\tif(browserIsEdge) {\r\n\r\n\t\t\t\tbuggyValues['*'] = 1; // make 0 values automatic for longhand properties\r\n\t\t\t\t\r\n\t\t\t\t//buggyValues['list-style-position:outside'] = 0;\r\n\t\t\t\tbuggyValues['list-style-image:none'] = 1;\r\n\t\t\t\t//buggyValues['outline-color:invert'] = 0;\r\n\t\t\t\t//buggyValues['outline-style:none'] = 0;\r\n\t\t\t\t//buggyValues['outline-width:medium'] = 0;\r\n\t\t\t\t//buggyValues['background-image:none'] = 0;\r\n\t\t\t\t//buggyValues['background-attachment:scroll'] = 0;\r\n\t\t\t\t//buggyValues['background-repeat:repeat'] = 0;\r\n\t\t\t\t//buggyValues['background-repeat-x:repeat'] = 0;\r\n\t\t\t\t//buggyValues['background-repeat-y:repeat'] = 0;\r\n\t\t\t\t//buggyValues['background-position-x:0%'] = 0;\r\n\t\t\t\t//buggyValues['background-position-y:0%'] = 0;\r\n\t\t\t\t//buggyValues['background-size:auto'] = 0;\r\n\t\t\t\t//buggyValues['background-origin:padding-box'] = 0;\r\n\t\t\t\t//buggyValues['background-clip:border-box'] = 0;\r\n\t\t\t\t//buggyValues['background-color:transparent'] = 0;\r\n\t\t\t\tbuggyValues['border-top-color:currentcolor'] = 1;\r\n\t\t\t\tbuggyValues['border-right-color:currentcolor'] = 1;\r\n\t\t\t\tbuggyValues['border-bottom-color:currentcolor'] = 1;\r\n\t\t\t\tbuggyValues['border-left-color:currentcolor'] = 1;\r\n\t\t\t\t//buggyValues['border-top-style:solid'] = 0;\r\n\t\t\t\t//buggyValues['border-right-style:solid'] = 0;\r\n\t\t\t\t//buggyValues['border-bottom-style:solid'] = 0;\r\n\t\t\t\t//buggyValues['border-left-style:solid'] = 0;\r\n\t\t\t\tbuggyValues['border-top-width:medium'] = 1;\r\n\t\t\t\tbuggyValues['border-right-width:medium'] = 1;\r\n\t\t\t\tbuggyValues['border-bottom-width:medium'] = 1;\r\n\t\t\t\tbuggyValues['border-left-width:medium'] = 1;\r\n\t\t\t\tbuggyValues['border-image-source:none'] = 1;\r\n\t\t\t\tbuggyValues['border-image-outset:0'] = 1;\r\n\t\t\t\tbuggyValues['border-image-width:1'] = 1;\r\n\t\t\t\tbuggyValues['border-image-repeat:repeat'] = 1;\r\n\t\t\t\tbuggyValues['border-image-repeat-x:repeat'] = 1;\r\n\t\t\t\tbuggyValues['border-image-repeat-y:repeat'] = 1;\r\n\t\t\t\tbuggyValues['line-height:normal'] = 1;\r\n\t\t\t\t//buggyValues['font-size-adjust:none'] = 0;\r\n\t\t\t\tbuggyValues['font-stretch:normal'] = 1;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Firefox reports initial values instead of \"initial\", we have to be cautious\r\n\t\t\tif(browserIsFirefox) {\r\n\t\t\t\t\r\n\t\t\t\tbuggyValues['*'] = 1; // make 0 values automatic for longhand properties\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Attempt to force to optimize the object somehow\r\n\t\t\tObject.create(buggyValues);\r\n\t\t\t\r\n\t\t\treturn getBuggyValuesForThisBrowser.cache = buggyValues;\r\n\r\n\t\t};\r\n\t\tvar valueExistsInRootProperty = (cssText,key,rootKey,value) => {\r\n\t\t\tvalue = value.trim().toLowerCase();\r\n\t\t\t\r\n\t\t\t// detect suspicious values\r\n\t\t\tvar buggyValues = getBuggyValuesForThisBrowser();\r\n\t\t\t\r\n\t\t\t// apply common sense to the given value, per browser\r\n\t\t\tvar buggyState = buggyValues[key+':'+value];\r\n\t\t\tif(buggyState === 1) { return false; }\r\n\t\t\tif(buggyState !== 0 && (!buggyValues['*'] || CSSShorthands.unexpand(key).length == 0)) { return true; }\r\n\r\n\t\t\t// root properties are unlikely to lie\r\n\t\t\tif(key==rootKey) return false;\t\t\t\r\n\t\t\t\r\n\t\t\t// ask the browser is the best we can do right now\r\n\t\t\tvar values = value.split(/\\s+|\\s*,\\s*/g);\r\n\t\t\tvar validValues = ' ';\r\n\t\t\tvar validValuesExtractor = new RegExp(' '+rootKey+'(?:[-][-_a-zA-Z0-9]+)?[:]([^;]*)','gi');\r\n\t\t\tvar match; while(match = validValuesExtractor.exec(cssText)) {\r\n\t\t\t\tvalidValues += match[1] + ' ';\r\n\t\t\t}\r\n\t\t\tfor(var i = 0; i < values.length; i++) {\r\n\t\t\t\tvar value = values[i];\r\n\t\t\t\tif(validValues.indexOf(' '+value+' ')==-1) return false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t\t\r\n\t\t};\r\n\t\t\r\n\t\t/** This will loop over the styles declarations */\r\n\t\tfunction analyzeStyleOfRule(style, selectorText, matchedElements, type, isInline) { isInline=!!isInline;\r\n\t\t\t\r\n\t\t\t// We want to filter rules that are not actually used\r\n\t\t\tvar count = matchedElements.length;\r\n\t\t\tvar selector = selectorText;\r\n\t\t\tvar selectorCat = {'1:true':'@inline','1:false':'@stylerule'}[''+type+':'+isInline]||'@atrule';\r\n\t\t\t\r\n\t\t\t// Keep track of unused rules\r\n\t\t\tvar isRuleUnused = (count == 0);\r\n\t\t\tif(isRuleUnused) {\r\n\t\t\t\tCSSUsage.StyleWalker.amountOfSelectorsUnused++;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// We need a generalized selector to collect some stats\r\n\t\t\tvar generalizedSelectors = (\r\n\t\t\t\t(selectorCat=='@stylerule')\r\n\t\t\t\t\t? [selectorCat].concat(generalizedSelectorsOf(selector))\r\n\t\t\t\t\t: [selectorCat, selector]\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\t// Get the datastores of the generalized selectors\r\n\t\t\tvar generalizedSelectorsData = map(generalizedSelectors, (generalizedSelector) => (\r\n\t\t\t\tCSSUsageResults.rules[generalizedSelector] || (CSSUsageResults.rules[generalizedSelector] = {count:0,props:Object.create(null)})\r\n\t\t\t));\r\n\t\t\t\r\n\t\t\t// Increment the occurence counter of found generalized selectors\r\n\t\t\tfor(var i = 0; i < generalizedSelectorsData.length; i++) {\r\n\t\t\t\tvar generalizedSelectorData = generalizedSelectorsData[i];\r\n\t\t\t\tgeneralizedSelectorData.count++\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// avoid most common browser lies\r\n\t\t\tvar cssText = ' '+style.cssText.toLowerCase(); \r\n\t\t\tif(browserIsEdge) {\r\n\t\t\t\tcssText = cssText.replace(/border: medium; border-image: none;/,'border: none;');\r\n\t\t\t\tcssText = cssText.replace(/ border-image: none;/,' ');\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// For each property declaration in this rule, we collect some stats\r\n\t\t\tfor (var i = style.length; i--;) {\r\n\r\n\t\t\t\tvar key = style[i], rootKeyIndex=key.indexOf('-'), rootKey = rootKeyIndex==-1 ? key : key.substr(0,rootKeyIndex);\r\n\t\t\t\tvar normalizedKey = rootKeyIndex==0&&key.indexOf('-',1)==1 ? '--var' : key;\r\n\t\t\t\tvar styleValue = style.getPropertyValue(key);\r\n\t\t\t\t\r\n\t\t\t\t// Only keep styles that were declared by the author\r\n\t\t\t\t// We need to make sure we're only checking string props\r\n\t\t\t\tvar isValueInvalid = typeof styleValue !== 'string' && styleValue != \"\" && styleValue != undefined;\r\n\t\t\t\tif (isValueInvalid) { \r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar isPropertyUndefined = (cssText.indexOf(' '+key+':') == -1) && (styleValue=='initial' || !valueExistsInRootProperty(cssText, key, rootKey, styleValue));\r\n\t\t\t\tif (isPropertyUndefined) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// divide the value into simplified components\r\n\t\t\t\tvar specifiedValuesArray = CSSUsage.CSSValues.createValueArray(styleValue,normalizedKey);\r\n\t\t\t\tvar values = new Array();\r\n\t\t\t\tfor(var j=specifiedValuesArray.length; j--;) {\r\n\t\t\t\t\tvalues.push(CSSUsage.CSSValues.parseValues(specifiedValuesArray[j],normalizedKey));\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// log the property usage per selector\r\n\t\t\t\tfor(var gs = 0; gs < generalizedSelectorsData.length; gs++) {\r\n\t\t\t\t\tvar generalizedSelectorData = generalizedSelectorsData[gs];\r\n\t\t\t\t\t// get the datastore for current property\r\n\t\t\t\t\tvar propStats = generalizedSelectorData.props[normalizedKey] || (generalizedSelectorData.props[normalizedKey] = {count:0,values:Object.create(null)});\r\n\r\n\t\t\t\t\t// we saw the property one time\r\n\t\t\t\t\tpropStats.count++;\r\n\t\t\t\t\t\r\n\t\t\t\t\t// we also saw a bunch of values\r\n\t\t\t\t\tfor(var v = 0; v < values.length; v++) {\r\n\t\t\t\t\t\tvar value = values[v];\t\t\t\t\r\n\t\t\t\t\t\t// increment the counts for those by one, too\r\n\t\t\t\t\t\tif(value.length>0) {\r\n\t\t\t\t\t\t\tpropStats.values[value] = (propStats.values[value]|0) + 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// if we may increment some counts due to this declaration\r\n\t\t\t\tif(count > 0) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// instanciate or fetch the property metadata\r\n\t\t\t\t\tvar propObject = CSSUsageResults.props[normalizedKey];\r\n\t\t\t\t\tif (!propObject) {\r\n\t\t\t\t\t\tpropObject = CSSUsageResults.props[normalizedKey] = {\r\n\t\t\t\t\t\t\tcount: 0,\r\n\t\t\t\t\t\t\tvalues: Object.create(null)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// update the occurence counts of the property and value\r\n\t\t\t\t\tfor(var e = 0; e < matchedElements.length; e++) {\r\n\t\t\t\t\t\tvar element = matchedElements[e];\r\n\r\n\t\t\t\t\t\t// check what the elements already contributed for this property\r\n\t\t\t\t\t\tvar cssUsageMeta = element.CSSUsage || (element.CSSUsage=Object.create(null));\r\n\t\t\t\t\t\tvar knownValues = cssUsageMeta[normalizedKey] || (cssUsageMeta[normalizedKey] = []);\r\n\r\n\t\t\t\t\t\t// For recipes, at times we want to look at the specified values as well so hang\r\n\t\t\t\t\t\t// these on the element so we don't have to recompute them\r\n\t\t\t\t\t\tknownValues.valuesArray = knownValues.valuesArray || (knownValues.valuesArray = []);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tfor(var sv = 0; sv < specifiedValuesArray.length; sv++) {\r\n\t\t\t\t\t\t\tvar currentSV = specifiedValuesArray[sv];\r\n\t\t\t\t\t\t\tif(knownValues.valuesArray.indexOf(currentSV) == -1) {\r\n\t\t\t\t\t\t\t\tknownValues.valuesArray.push(currentSV)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// increment the amount of affected elements which we didn't count yet\r\n\t\t\t\t\t\tif(knownValues.length == 0) { propObject.count += 1; }\r\n\r\n\t\t\t\t\t\t// add newly found values too\r\n\t\t\t\t\t\tfor(var v = 0; v < values.length; v++) {\r\n\t\t\t\t\t\t\tvar value = values[v];\r\n\t\t\t\t\t\t\tif(knownValues.indexOf(value) >= 0) { return; }\r\n\t\t\t\t\t\t\tpropObject.values[value] = (propObject.values[value]|0) + 1;\r\n\t\t\t\t\t\t\tknownValues.push(value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfunction finalize() {\r\n\t\t\t\r\n\t\t\t// anonymize identifiers used for animation-name\r\n\t\t\tfunction removeAnimationNames() {\r\n\t\t\t\t\r\n\t\t\t\t// anonymize identifiers used for animation-name globally\r\n\t\t\t\tif(CSSUsageResults.props[\"animation-name\"]) {\r\n\t\t\t\t\tCSSUsageResults.props[\"animation-name\"].values = {\"<custom-ident>\":CSSUsageResults.props[\"animation-name\"].count};\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// anonymize identifiers used for animation-name per selector\r\n\t\t\t\tfor(var selector in CSSUsageResults.rules) { \r\n\t\t\t\t\tvar rule = CSSUsageResults.rules[selector];\r\n\t\t\t\t\tif(rule && rule.props && rule.props[\"animation-name\"]) {\r\n\t\t\t\t\t\trule.props[\"animation-name\"].values = {\"<custom-ident>\":rule.props[\"animation-name\"].count};\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tremoveAnimationNames();\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\t//-------------------------------------------------------------------------\r\n\r\n\t\t/**\r\n\t\t * If you try to do querySelectorAll on pseudo selectors\r\n\t\t * it returns 0 because you are not actually doing the action the pseudo is stating those things,\r\n\t\t * but we will honor those declarations and we don't want them to be missed,\r\n\t\t * so we remove the pseudo selector from the selector text\r\n\t\t */\r\n\t\tfunction cleanSelectorText(text) {\r\n\t\t\tif(text.indexOf(':') == -1) {\r\n\t\t\t\treturn text;\r\n\t\t\t} else {\r\n\t\t\t\treturn text.replace(/([-_a-zA-Z0-9*\\[\\]]?):(?:hover|active|focus|before|after|not\\(:(hover|active|focus)\\))|::(?:before|after)/gi, '>>$1<<').replace(/(^| |>|\\+|~)>><</g,'$1*').replace(/\\(>><<\\)/g,'(*)').replace(/>>([-_a-zA-Z0-9*\\[\\]]?)<</g,'$1');\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t/**\r\n\t\t * Returns an anonymized version of the selector.\r\n\t\t * @example \"#menu.open:hover>a.submenu\" => \"#id.class:hover > a.class\"\r\n\t\t */\r\n\t\tfunction generalizedSelectorsOf(value) {\r\n\t\t\t\r\n\t\t\t// Trim\r\n\t\t\tvalue = value.trim();\r\n\t\t\t\r\n\t\t\t// Collapse whitespace\r\n\t\t\tif (value) {\r\n\t\t\t\tvalue = value.replace(/\\s+/g, \" \");\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Remove (...)\r\n\t\t\tif (value.indexOf(\"(\") != -1) {\r\n\t\t\t\tvalue = value.replace(/[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]*)[)])*[)])*[)])*[)])*[)]/g, \"\");\r\n\t\t\t\tvalue = value.replace(/[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]+|[(](?:[^()]*)[)])*[)])*[)])*[)])*[)]/g, \"\");\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Simplify \"...\" and '...'\r\n\t\t\tvalue = value.replace(/\"([^\"\\\\]|\\\\[^\"\\\\]|\\\\\\\\|\\\\\")*\"/g,'\"\"')\r\n\t\t\tvalue = value.replace(/'([^'\\\\]|\\\\[^'\\\\]|\\\\\\\\|\\\\')*'/g,\"''\");\r\n\r\n\t\t\t\r\n\t\t\t// Simplify [att]\r\n\t\t\tif (value.indexOf(\"[\") != -1) {\r\n\t\t\t\tvalue = value.replace(/\\[[^=\\[\\]]+=\"([^\"\\\\]|\\\\[^\"\\\\]|\\\\\\\\|\\\\\")*\"\\]/g, \"[a]\");\r\n\t\t\t\tvalue = value.replace(/\\[[^=\\[\\]]+='([^'\\\\]|\\\\[^'\\\\]|\\\\\\\\|\\\\')*'\\]/g, \"[a]\");\r\n\t\t\t\tvalue = value.replace(/\\[[^\\[\\]]+\\]/g, \"[a]\");\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Simplify .class\r\n\t\t\tif (value.indexOf(\".\") != -1) {\r\n\t\t\t\tvalue = value.replace(/[.][-_a-zA-Z][-_a-zA-Z0-9]*/g, \".c\");\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Simplify #id\r\n\t\t\tif (value.indexOf(\"#\") != -1) {\r\n\t\t\t\tvalue = value.replace(/[#][-_a-zA-Z][-_a-zA-Z0-9]*/g, \"#i\");\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Normalize combinators\r\n\t\t\tvalue = value.replace(/[ ]*([>|+|~])[ ]*/g,' $1 ');\r\n\t\t\t\r\n\t\t\t// Trim whitespace\r\n\t\t\tvalue = value.trim();\r\n\t\t\t\r\n\t\t\t// Remove unnecessary * to match Chrome\r\n\t\t\tvalue = value.replace(/[*]([#.\\x5B:])/g,'$1');\r\n\t\t\t\r\n\t\t\t// Now we can sort components so that all browsers give results similar to Chrome\r\n\t\t\tvalue = sortSelectorComponents(value)\r\n\t\t\t\r\n\t\t\t// Split multiple selectors\r\n\t\t\tvalue = value.split(/\\s*,\\s*/g);\r\n\r\n\t\t\treturn value;\r\n\r\n\t\t}\r\n\t\t\r\n\t\tvar ID_REGEXP = \"[#]i\";         // #id\r\n\t\tvar CLASS_REGEXP = \"[.]c\";      // .class\r\n\t\tvar ATTR_REGEXP = \"\\\\[a\\\\]\";    // [att]\r\n\t\tvar PSEUDO_REGEXP = \"[:][:]?[-_a-zA-Z][-_a-zA-Z0-9]*\"; // :pseudo\r\n\t\tvar SORT_REGEXPS = [\r\n\t\t\t\r\n\t\t\t// #id first\r\n\t\t\tnew RegExp(\"(\"+CLASS_REGEXP+\")(\"+ID_REGEXP+\")\",'g'),\r\n\t\t\tnew RegExp(\"(\"+ATTR_REGEXP+\")(\"+ID_REGEXP+\")\",'g'),\r\n\t\t\tnew RegExp(\"(\"+PSEUDO_REGEXP+\")(\"+ID_REGEXP+\")\",'g'),\r\n\t\t\t\r\n\t\t\t// .class second\r\n\t\t\tnew RegExp(\"(\"+ATTR_REGEXP+\")(\"+CLASS_REGEXP+\")\",'g'),\r\n\t\t\tnew RegExp(\"(\"+PSEUDO_REGEXP+\")(\"+CLASS_REGEXP+\")\",'g'),\r\n\t\t\t\r\n\t\t\t// [attr] third\r\n\t\t\tnew RegExp(\"(\"+PSEUDO_REGEXP+\")(\"+ATTR_REGEXP+\")\",'g'),\r\n\t\t\t\r\n\t\t\t// :pseudo last\r\n\t\t\t\r\n\t\t];\r\n\t\tfunction sortSelectorComponents(value) {\r\n\t\t\t\r\n\t\t\tvar oldValue; do { // Yeah this is a very inefficient bubble sort. I know.\r\n\t\t\t\t\r\n\t\t\t\toldValue = value;\r\n\t\t\t\tfor(var i = 0; i < SORT_REGEXPS.length; i++) {\r\n\t\t\t\t\tvar wrongPair = SORT_REGEXPS[i];\r\n\t\t\t\t\tvalue = value.replace(wrongPair,'$2$1');\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t} while(oldValue != value); return value;\r\n\r\n\t\t}\r\n\r\n\t}();\r\n\r\n\t//\r\n\t// extracts valuable informations about selectors in use\r\n\t//\r\n\tvoid function() {\r\n\t\t\r\n\t\t// \r\n\t\t// To understand framework and general css usage, we collect stats about classes, ids and pseudos.\r\n\t\t// Those objects have the following shape: \r\n\t\t// {\"hover\":5,\"active\":1,\"focus\":2}\r\n\t\t// \r\n\t\tvar cssPseudos = Object.create(null); // collect stats about which pseudo-classes and pseudo-elements are used in the css\r\n\t\tvar domClasses = Object.create(null); // collect stats about which css classes are found in the <... class> attributes of the dom\r\n\t\tvar cssClasses = Object.create(null); // collect stats about which css classes are used in the css\r\n\t\tvar domIds = Object.create(null);     // collect stats about which ids are found in the <... id> attributes of the dom\r\n\t\tvar cssIds = Object.create(null);     // collect stats about which ids are used in the css\r\n\t\t\r\n\t\t// \r\n\t\t// To understand Modernizer usage, we need to know how often some classes are used at the front of a selector\r\n\t\t// While we're at it, the code also collect the state for ids\r\n\t\t// \r\n\t\tvar cssLonelyIdGates = Object.create(null);    // .class something-else ==> {\"class\":1}\r\n\t\tvar cssLonelyClassGates = Object.create(null); // #id something-else ==> {\"id\":1}\r\n\t\tvar cssLonelyClassGatesMatches = [];           // .class something-else ==> [\".class something-else\"]\r\n\t\tvar cssLonelyIdGatesMatches = [];              // #id something-else ==> [\"#id something-else\"]\r\n\t\t\r\n\t\t//\r\n\t\t// These regular expressions catch patterns we want to track (see before)\r\n\t\t//\r\n\t\tvar ID_REGEXP = /[#][-_a-zA-Z][-_a-zA-Z0-9]*/g;     // #id\r\n\t\tvar ID_REGEXP1 = /[#][-_a-zA-Z][-_a-zA-Z0-9]*/;     // #id (only the first one)\r\n\t\tvar CLASS_REGEXP = /[.][-_a-zA-Z][-_a-zA-Z0-9]*/g;  // .class\r\n\t\tvar CLASS_REGEXP1 = /[.][-_a-zA-Z][-_a-zA-Z0-9]*/;  // .class (only the first one)\r\n\t\tvar PSEUDO_REGEXP = /[:][-_a-zA-Z][-_a-zA-Z0-9]*/g; // :pseudo (only the )\r\n\t\tvar GATEID_REGEXP = /^\\s*[#][-_a-zA-Z][-_a-zA-Z0-9]*([.][-_a-zA-Z][-_a-zA-Z0-9]*|[:][-_a-zA-Z][-_a-zA-Z0-9]*)*\\s+[^>+{, ][^{,]+$/; // #id ...\r\n\t\tvar GATECLASS_REGEXP = /^\\s*[.][-_a-zA-Z][-_a-zA-Z0-9]*([:][-_a-zA-Z][-_a-zA-Z0-9]*)*\\s+[^>+{, ][^{,]+$/; // .class ...\r\n\t\t\r\n\t\t/**\r\n\t\t * From a css selector text and a set of counters, \r\n\t\t * increment the counters for the matches in the selector of the 'feature' regular expression\r\n\t\t */\r\n\t\tfunction extractFeature(feature, selector, counters) {\r\n\t\t\tvar instances = selector.match(feature)||[];\r\n\t\t\tfor(var i = 0; i < instances.length; i++) {\r\n\t\t\t\tvar instance = instances[i];\r\n\t\t\t\tinstance = instance.substr(1);\r\n\t\t\t\tcounters[instance] = (counters[instance]|0) + 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t/**\r\n\t\t * This analyzer will collect over the selectors the stats defined before\r\n\t\t */\r\n\t\tCSSUsage.SelectorAnalyzer = function parseSelector(style, selectorsText) {\r\n\t\t\tif(typeof selectorsText != 'string') return;\r\n\t\t\t\t\r\n\t\t\tvar selectors = selectorsText.split(',');\r\n\t\t\tfor(var i = selectors.length; i--;) { var selector = selectors[i];\r\n\t\t\t\t\r\n\t\t\t\t// extract all features from the selectors\r\n\t\t\t\textractFeature(ID_REGEXP, selector, cssIds);\r\n\t\t\t\textractFeature(CLASS_REGEXP, selector, cssClasses);\r\n\t\t\t\textractFeature(PSEUDO_REGEXP, selector, cssPseudos);\r\n\t\t\t\t\r\n\t\t\t\t// detect specific selector patterns we're interested in\r\n\t\t\t\tif(GATEID_REGEXP.test(selector)) {\r\n\t\t\t\t\tcssLonelyIdGatesMatches.push(selector);\r\n\t\t\t\t\textractFeature(ID_REGEXP1, selector, cssLonelyIdGates);\r\n\t\t\t\t}\r\n\t\t\t\tif(GATECLASS_REGEXP.test(selector)) {\r\n\t\t\t\t\tcssLonelyClassGatesMatches.push(selector);\r\n\t\t\t\t\textractFeature(CLASS_REGEXP1, selector, cssLonelyClassGates);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t/**\r\n\t\t * This analyzer will collect over the dom elements the stats defined before\r\n\t\t */\r\n\t\tCSSUsage.DOMClassAnalyzer = function(element) {\r\n\t\t\t\r\n\t\t\t// collect classes used in the wild\r\n\t\t\tif(element.className) {\r\n\t\t\t\tvar elementClasses = element.classList;\r\n\t\t\t\tfor(var cl = 0; cl < elementClasses.length; cl++) {\r\n\t\t\t\t\tvar c = elementClasses[cl];\r\n\t\t\t\t\tdomClasses[c] = (domClasses[c]|0) + 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// collect ids used in the wild\r\n\t\t\tif(element.id) {\r\n\t\t\t\tdomIds[element.id] = (domIds[element.id]|0) + 1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t/**\r\n\t\t * This function will be called when all stats have been collected\r\n\t\t * at which point we will agregate some of them in useful values like Bootstrap usages, etc...\r\n\t\t */\r\n\t\tCSSUsage.SelectorAnalyzer.finalize = function() {\r\n\t\t\t\r\n\t\t\t// get arrays of the classes/ids used ({\"hover\":5} => [\"hover\"]))\r\n\t\t\tvar domClassesArray = Object.keys(domClasses);\r\n\t\t\tvar cssClassesArray = Object.keys(cssClasses);\r\n\t\t\tvar domIdsArray = Object.keys(domIds);\r\n\t\t\tvar cssIdsArray = Object.keys(cssIds);\r\n\r\n\t\t\tvar results = {\t\t\t\t\r\n\t\t\t\t// how many crawls are aggregated in this file (one of course in this case)\r\n\t\t\t\tSuccessfulCrawls: 1,\r\n\t\t\t\t\r\n\t\t\t\t// how many elements on the page (used to compute percentages for css.props)\r\n\t\t\t\tDOMElements: document.all.length,\r\n\t\t\t\t\r\n\t\t\t\t// how many selectors vs inline style, and other usage stats\r\n\t\t\t\tSelectorsFound: CSSUsage.StyleWalker.amountOfSelectors,\r\n\t\t\t\tInlineStylesFound: CSSUsage.StyleWalker.amountOfInlineStyles,\r\n\t\t\t\tSelectorsUnused: CSSUsage.StyleWalker.amountOfSelectorsUnused,\r\n\t\t\t\t\r\n\t\t\t\t// ids stats\r\n\t\t\t\tIdsUsed: domIdsArray.length,\r\n\t\t\t\tIdsRecognized: Object.keys(cssIds).length,\r\n\t\t\t\tIdsUsedRecognized: filter(domIdsArray, i => cssIds[i]).length,\r\n\t\t\t\t\r\n\t\t\t\t// classes stats\r\n\t\t\t\tClassesUsed: domClassesArray.length,\r\n\t\t\t\tClassesRecognized: Object.keys(cssClasses).length,\r\n\t\t\t\tClassesUsedRecognized: filter(domClassesArray, c => cssClasses[c]).length,\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tresults = getFwkUsage(results, cssLonelyClassGates, domClasses, domIds, cssLonelyIdGates, cssClasses);\r\n\t\t\tresults = getPatternUsage(results, domClasses, cssClasses);\r\n\t\t\t\r\n\t\t\tCSSUsageResults.usages = results;\r\n\t\t\tif(window.debugCSSUsage) console.log(CSSUsageResults.usages);\r\n\t\t}\r\n\r\n\t\t\r\n\t\t\t\r\n\t}();\r\n\r\n\t//\r\n\t// Execution scheduler:\r\n\t// This is where we decide what to run, and when\r\n\t//\r\n\tvoid function() {\r\n\r\n\t\tif(document.readyState !== 'complete') {\r\n\t\t\t\r\n\t\t\t// if the document is loading, run when it loads or in 10s, whichever is less\r\n\t\t\twindow.addEventListener('load', onready);\r\n\t\t\tsetTimeout(onready, 10000);\r\n\t\t\t\r\n\t\t} else {\r\n\t\t\t\r\n\t\t\t// if the document is ready, run now\r\n\t\t\tonready();\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * This is the main entrypoint of our script\r\n\t\t */\r\n\t\tfunction onready() {\r\n\t\t\t\r\n\t\t\t// Uncomment if you want to set breakpoints when running in the console\r\n\t\t\t//debugger;\r\n\t\t\t\r\n\t\t\t// Prevent this code from running multiple times\r\n\t\t\tvar firstTime = !onready.hasAlreadyRun; onready.hasAlreadyRun = true;\r\n\t\t\tif(!firstTime) { return; /* for now... */ }\r\n\t\t\t\r\n\t\t\t// Prevent this code from running when the page has no stylesheet (probably a redirect page)\r\n\t\t\tif(document.styleSheets.length == 0) { return; }\r\n\r\n\t\t\t// Check to see if you're on a Firefox failure page\r\n\t\t\tif(document.styleSheets.length == 1 && browserIsFirefox) {\r\n\t\t\t\tif(document.styleSheets[0].href.indexOf('aboutNetError') != -1) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Keep track of duration\r\n\t\t\tvar startTime = performance.now();\r\n\r\n\t\t\t// register tools\r\n\t\t\tCSSUsage.StyleWalker.ruleAnalyzers.push(CSSUsage.PropertyValuesAnalyzer);\r\n\t\t\tCSSUsage.StyleWalker.ruleAnalyzers.push(CSSUsage.SelectorAnalyzer);\r\n\t\t\tCSSUsage.StyleWalker.elementAnalyzers.push(CSSUsage.DOMClassAnalyzer);\r\n\t\t\tCSSUsage.StyleWalker.elementAnalyzers.push(HtmlUsage.GetNodeName);\t\t\t\r\n\r\n\t\t\t// perform analysis\r\n\t\t\tCSSUsage.StyleWalker.walkOverDomElements();\r\n\t\t\tCSSUsage.StyleWalker.walkOverCssStyles();\t\t\t\r\n\t\t\tCSSUsage.PropertyValuesAnalyzer.finalize();\r\n\t\t\tCSSUsage.SelectorAnalyzer.finalize();\r\n\r\n\t\t\t// Walk over the dom elements again for Recipes\r\n\t\t\tCSSUsage.StyleWalker.runRecipes = true;\r\n\t\t\tCSSUsage.StyleWalker.walkOverDomElements();\r\n\r\n\t\t\t// Update duration\r\n\t\t\tCSSUsageResults.duration = (performance.now() - startTime)|0;\r\n\r\n\t\t\t// DO SOMETHING WITH THE CSS OBJECT HERE\r\n\t\t\tif(window.debugCSSUsage) console.log(CSSUsageResults);\r\n\t\t\tif(window.onCSSUsageResults) {\r\n\t\t\t\twindow.onCSSUsageResults(CSSUsageResults);\r\n\t\t\t};\r\n\t\t\t\r\n\t\t}\r\n\r\n\r\n\t}();\r\n\t\r\n} catch (ex) { /* do something maybe */ throw ex; } }();\r\n/* \r\n    RECIPE: Metaviewport\r\n    -------------------------------------------------------------\r\n    Author: Greg Whitworth\r\n    Description: This will provide the values for the meta tag\r\n    that also uses a content value with the values we're interested in.\r\n*/\r\n\r\nvoid function() {\r\n    window.CSSUsage.StyleWalker.recipesToRun.push( function metaviewport(/*HTML DOM Element*/ element, results) {\r\n        var needles = [\"width\", \"height\", \"initial-scale\", \"minimum-scale\", \"maximum-scale\", \"user-scalable\"];\r\n\r\n        if(element.nodeName == \"META\") {\r\n            for(var n = 0; n < element.attributes.length; n++) {\r\n                if(element.attributes[n].name == \"content\") {\r\n                    \r\n                    for(var needle = 0; needle < needles.length; needle++) {\r\n                        var value = element.attributes[n].value;\r\n\r\n                        if(value.indexOf(needles[needle] != -1)) {\r\n                            results[value] = results[value] || { count: 0 };\r\n                            results[value].count++;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }    \r\n        }\r\n\r\n        return results;\r\n    });\r\n}();\r\n/* \r\n    RECIPE: PADDING HACK\r\n    -------------------------------------------------------------\r\n    Author: Greg Whitworth\r\n    Description: The padding hack is utilized in CSS by setting\r\n    a bottom padding with a percentage value of great than 50%\r\n    as this forces the box to set its height to that of the width\r\n    and artificially creating aspect ratio based on its contents.\r\n*/\r\n\r\nvoid function() {\r\n    window.CSSUsage.StyleWalker.recipesToRun.push( function paddingHack(/*HTML DOM Element*/ element, results) {\r\n\r\n        // Bail if the element doesn't have the props we're looking for\r\n        if(!element.CSSUsage || !(element.CSSUsage[\"padding-bottom\"] || element.CSSUsage[\"padding-top\"])) return;\r\n        \r\n        var values = [];     \r\n\r\n        // Build up a stack of values to interrogate\r\n        if(element.CSSUsage[\"padding-top\"]) {\r\n            values = values.concat(element.CSSUsage[\"padding-top\"].valuesArray);         \r\n        }\r\n        \r\n        if(element.CSSUsage[\"padding-bottom\"]) {\r\n            values = values.concat(element.CSSUsage[\"padding-bottom\"].valuesArray); \r\n        }\r\n\r\n        for(var i = 0; i < values.length; i++) {\r\n            if(values[i].indexOf('%')) {\r\n                var value = values[i].replace('%', \"\");\r\n                value = parseFloat(value);\r\n\r\n                if(value > 50) {\r\n                    results[value] = results[value] || { count: 0 };\r\n                    results[value].count++;\r\n                }\r\n            }\r\n        }\r\n\r\n        return results;\r\n    });\r\n}();\r\n/* \r\n    RECIPE: <NAME OF RECIPE>\r\n    -------------------------------------------------------------\r\n    Author: <YOUR NAME>\r\n    Description: <WHAT IS YOUR RECIPE LOOKING FOR>\r\n\r\nvoid function() {\r\n    window.CSSUsage.StyleWalker.recipesToRun.push( function <NameYourRecipe>( element, results) {\r\n        return results;\r\n    });\r\n}();\r\n\r\n*/"]}